[33m2025-05-20 23:14:22,282 - driver_manager - WARNING - Driver ignored. Error loading nvflare.fuel.f3.drivers.aio_http_driver: [Errno 2] No such file or directory[0m
[33m2025-05-20 23:14:22,292 - driver_manager - WARNING - Driver ignored. Error loading nvflare.fuel.f3.drivers.aio_http_driver: [Errno 2] No such file or directory[0m
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 70.70it/s]
[38m2025-05-20 23:14:26,354 - IntimeModelSelector - INFO - model selection weights control: {}[0m
[38m2025-05-20 23:14:26,438 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:14:26,439 - ModelDequantizer - INFO - Using model dequantizator.[0m
🔔 EVENT RECEIVED: _start_run
🚀 Initializing persistor
[38m2025-05-20 23:14:26,443 - FedAvg - INFO - Initializing BaseModelController workflow.[0m
🔔 EVENT RECEIVED: _start_workflow
[38m2025-05-20 23:14:26,443 - FedAvg - INFO - Beginning model controller run.[0m
🔔 EVENT RECEIVED: _training_started
[38m2025-05-20 23:14:26,443 - FedAvg - INFO - Start FedAvg.[0m
[38m2025-05-20 23:14:26,444 - FedAvg - INFO - loading initial model from persistor[0m
🔔 EVENT RECEIVED: _initial_model_loaded
[38m2025-05-20 23:14:26,445 - FedAvg - INFO - Round 0 started.[0m
[38m2025-05-20 23:14:26,445 - FedAvg - INFO - Sampled clients: ['site-code', 'site-math', 'site-lbv1'][0m
[38m2025-05-20 23:14:26,445 - FedAvg - INFO - Sending task train to ['site-code', 'site-math', 'site-lbv1'][0m
[38m2025-05-20 23:14:30,997 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:14:30,998 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:14:31,114 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:14:31,115 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:14:31,510 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-math/simulate_job/app_site-math/custom/src/pretrain_nvflare.py[0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _before_train_task
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_data_filter
[38m2025-05-20 23:14:31,513 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:14:31,514 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:14:31,628 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:14:31,628 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,628 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:14:31,628 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,629 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:14:31,629 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,629 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:14:31,629 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,629 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:14:31,629 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,630 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:14:31,630 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,630 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:14:31,630 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,630 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:14:31,631 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:14:31,631 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,631 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:14:31,631 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,631 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:14:31,631 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,632 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:14:31,632 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,632 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:14:31,632 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:14:31,632 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,632 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:14:31,633 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,633 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:14:31,633 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:14:31,633 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,633 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:14:31,634 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,634 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:14:31,634 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:14:31,634 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,634 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:14:31,634 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,635 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:14:31,635 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:14:31,635 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:14:31,635 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,635 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:14:31,635 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:14:31,636 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:14:31,636 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,636 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:14:31,636 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:14:31,636 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,636 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:14:31,637 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:14:31,637 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,637 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:14:31,637 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:14:31,637 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:14:31,637 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:14:31,638 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:14:31,638 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:14:31,638 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:14:31,638 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:14:31,638 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,638 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:14:31,639 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,639 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:14:31,639 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:14:31,639 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:14:31,639 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:14:31,639 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:14:31,640 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:14:31,640 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:14:31,640 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:14:31,640 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:14:31,640 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:14:31,640 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:14:31,640 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:14:31,641 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:14:31,641 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:14:31,641 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:14:31,641 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:14:31,641 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:14:31,641 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:14:31,642 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:14:31,642 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:14:31,642 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:14:31,642 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:14:31,642 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:14:31,642 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:14:31,643 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _before_train_task
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_data_filter
[38m2025-05-20 23:14:31,646 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:14:31,646 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:14:31,646 - ModelQuantizer - INFO - Skipping quantization for model.model.embed_tokens.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,647 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,647 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,647 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,647 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,648 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,648 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,701 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,701 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,702 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,702 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,702 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,702 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,703 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,709 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,710 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,743 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,767 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,768 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,769 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,769 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,789 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:14:31,790 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,790 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:14:31,791 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,791 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:14:31,792 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,793 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:14:31,793 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,794 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:14:31,794 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,795 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:14:31,795 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,796 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:14:31,796 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,797 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:14:31,797 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:14:31,798 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,798 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:14:31,799 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,800 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:14:31,800 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,800 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:14:31,800 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,801 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:14:31,801 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:14:31,801 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,801 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:14:31,802 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,802 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:14:31,802 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:14:31,803 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,803 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:14:31,803 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,803 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:14:31,804 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:14:31,804 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:14:31,804 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:14:31,804 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,804 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:14:31,805 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:14:31,805 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:14:31,805 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,805 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:14:31,806 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:14:31,806 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:14:31,806 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,807 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:14:31,807 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:14:31,807 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,807 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,807 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:14:31,807 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,808 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:14:31,808 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,808 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,808 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:14:31,808 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:14:31,808 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:14:31,809 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:14:31,809 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:14:31,809 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:14:31,809 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:14:31,809 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:14:31,810 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,810 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:14:31,810 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:31,810 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:14:31,810 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:14:31,811 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:14:31,811 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:14:31,811 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:14:31,811 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:14:31,811 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:14:31,812 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:14:31,812 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:14:31,812 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:14:31,812 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:14:31,813 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:14:31,813 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:14:31,813 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:14:31,813 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:14:31,814 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:14:31,814 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:14:31,814 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:14:31,814 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:14:31,815 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:14:31,815 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:14:31,815 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:14:31,816 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:14:31,816 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:14:31,905 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,905 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,906 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,906 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,907 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,925 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,926 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,953 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,976 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:31,976 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,074 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,075 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,075 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,146 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,147 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,147 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,160 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,160 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,177 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,178 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,178 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,224 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,224 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,225 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,225 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,226 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,226 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,227 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,228 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,291 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,291 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,292 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,292 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,293 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,293 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,294 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,294 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,295 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,354 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,355 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,355 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,356 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,356 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,357 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,357 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,358 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,359 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,412 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,413 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,413 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,414 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,414 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,429 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,430 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,430 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,431 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,465 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,466 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,467 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,467 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,467 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,467 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,480 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,480 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,481 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,533 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,534 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,534 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,535 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,545 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,546 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,546 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,617 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,618 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,618 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,618 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,619 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,630 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,631 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,664 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,665 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,665 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,666 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,666 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,681 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,681 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,682 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,682 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,714 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,732 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,733 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,734 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,745 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,745 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,746 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,746 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,821 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,822 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,822 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,822 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,823 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,823 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,824 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,825 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,886 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,887 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,887 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:32,887 - ModelQuantizer - INFO - Skipping quantization for model.model.norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:33,036 - ModelQuantizer - INFO - Quantized 138/179 params. Before quantization: 5376.43 MB. After quantization: 2544.18 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:14:33,037 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float16', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float16', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.2.self_attn.q_proj.weight': 'float16', 'model.model.layers.2.self_attn.k_proj.weight': 'float16', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float16', 'model.model.layers.4.post_attention_layernorm.weight': 'float16', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float16', 'model.model.layers.5.self_attn.v_proj.weight': 'float16', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float16', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.11.self_attn.q_proj.weight': 'float16', 'model.model.layers.11.self_attn.k_proj.weight': 'float16', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float16', 'model.model.layers.11.self_attn.q_norm.weight': 'float16', 'model.model.layers.11.self_attn.k_norm.weight': 'float16', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float16', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.12.self_attn.q_proj.weight': 'float16', 'model.model.layers.12.self_attn.k_proj.weight': 'float16', 'model.model.layers.12.self_attn.v_proj.weight': 'float16', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float16', 'model.model.layers.12.self_attn.k_norm.weight': 'float16', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float16', 'model.model.layers.12.mlp.down_proj.weight': 'float16', 'model.model.layers.12.post_attention_layernorm.weight': 'float16', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.13.self_attn.q_proj.weight': 'float16', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float16', 'model.model.layers.13.self_attn.o_proj.weight': 'float16', 'model.model.layers.13.self_attn.q_norm.weight': 'float16', 'model.model.layers.13.self_attn.k_norm.weight': 'float16', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float16', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float16', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.14.self_attn.q_proj.weight': 'float16', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float16', 'model.model.layers.14.self_attn.o_proj.weight': 'float16', 'model.model.layers.14.self_attn.q_norm.weight': 'float16', 'model.model.layers.14.self_attn.k_norm.weight': 'float16', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
🔔 EVENT RECEIVED: _after_task_data_filter
[38m2025-05-20 23:14:33,136 - ModelQuantizer - INFO - Quantized 88/179 params. Before quantization: 4624.33 MB. After quantization: 1792.08 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:14:33,222 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float16', 'model.model.layers.0.self_attn.q_proj.weight': 'float16', 'model.model.layers.0.self_attn.k_proj.weight': 'float16', 'model.model.layers.0.self_attn.v_proj.weight': 'float16', 'model.model.layers.0.self_attn.o_proj.weight': 'float16', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float16', 'model.model.layers.0.mlp.down_proj.weight': 'float16', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float16', 'model.model.layers.1.self_attn.v_proj.weight': 'float16', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float16', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float16', 'model.model.layers.3.self_attn.v_proj.weight': 'float16', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float16', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float16', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float16', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float16', 'model.model.layers.6.self_attn.k_proj.weight': 'float16', 'model.model.layers.6.self_attn.v_proj.weight': 'float16', 'model.model.layers.6.self_attn.o_proj.weight': 'float16', 'model.model.layers.6.self_attn.q_norm.weight': 'float16', 'model.model.layers.6.self_attn.k_norm.weight': 'float16', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float16', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float16', 'model.model.layers.7.self_attn.k_proj.weight': 'float16', 'model.model.layers.7.self_attn.v_proj.weight': 'float16', 'model.model.layers.7.self_attn.o_proj.weight': 'float16', 'model.model.layers.7.self_attn.q_norm.weight': 'float16', 'model.model.layers.7.self_attn.k_norm.weight': 'float16', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float16', 'model.model.layers.7.post_attention_layernorm.weight': 'float16', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.8.self_attn.q_proj.weight': 'float16', 'model.model.layers.8.self_attn.k_proj.weight': 'float16', 'model.model.layers.8.self_attn.v_proj.weight': 'float16', 'model.model.layers.8.self_attn.o_proj.weight': 'float16', 'model.model.layers.8.self_attn.q_norm.weight': 'float16', 'model.model.layers.8.self_attn.k_norm.weight': 'float16', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float16', 'model.model.layers.8.post_attention_layernorm.weight': 'float16', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.9.self_attn.q_proj.weight': 'float16', 'model.model.layers.9.self_attn.k_proj.weight': 'float16', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float16', 'model.model.layers.9.self_attn.q_norm.weight': 'float16', 'model.model.layers.9.self_attn.k_norm.weight': 'float16', 'model.model.layers.9.mlp.gate_proj.weight': 'float16', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float16', 'model.model.layers.9.post_attention_layernorm.weight': 'float16', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.10.self_attn.q_proj.weight': 'float16', 'model.model.layers.10.self_attn.k_proj.weight': 'float16', 'model.model.layers.10.self_attn.v_proj.weight': 'float16', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float16', 'model.model.layers.10.self_attn.k_norm.weight': 'float16', 'model.model.layers.10.mlp.gate_proj.weight': 'float16', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float16', 'model.model.layers.15.self_attn.k_proj.weight': 'float16', 'model.model.layers.15.self_attn.v_proj.weight': 'float16', 'model.model.layers.15.self_attn.o_proj.weight': 'float16', 'model.model.layers.15.self_attn.q_norm.weight': 'float16', 'model.model.layers.15.self_attn.k_norm.weight': 'float16', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float16', 'model.model.layers.15.post_attention_layernorm.weight': 'float16', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float16', 'model.model.norm.weight': 'float16', 'model.lm_head.weight': 'float32'} to float16[0m
[38m2025-05-20 23:14:34,437 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/math/train.npy[0m
[38m2025-05-20 23:14:34,437 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/math/train.npy...[0m
[38m2025-05-20 23:14:34,438 - TaskScriptRunner - INFO - data_array shape: (100644201,)[0m
[38m2025-05-20 23:14:34,438 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:14:34,438 - TaskScriptRunner - INFO - data_array size: 100644201[0m
[38m2025-05-20 23:14:34,733 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy[0m
[38m2025-05-20 23:14:34,734 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy...[0m
[38m2025-05-20 23:14:34,734 - TaskScriptRunner - INFO - data_array shape: (988118026,)[0m
[38m2025-05-20 23:14:34,735 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:14:34,735 - TaskScriptRunner - INFO - data_array size: 988118026[0m
[38m2025-05-20 23:14:36,268 - TaskScriptRunner - INFO - 100644201 len text_list[0m
[38m2025-05-20 23:14:37,159 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:14:37,168 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/math/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:14:37,172 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:14:37,173 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:14:37,173 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:14:37,173 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:14:37,174 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:14:37,174 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,174 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:14:37,174 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,174 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:14:37,175 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:14:37,175 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:14:37,175 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,175 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:14:37,175 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:14:37,175 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,176 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:14:37,176 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:14:37,176 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,176 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:14:37,176 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:14:37,176 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:14:37,177 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:14:37,177 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:14:37,177 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,177 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:14:37,177 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:14:37,177 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:14:37,178 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,178 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:14:37,178 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:14:37,178 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:14:37,178 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:14:37,178 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:14:37,179 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:14:37,179 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:14:37,179 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:14:37,179 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,179 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:14:37,179 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:14:37,180 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:14:37,180 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:14:37,180 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7fee2a513ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-math/simulate_job/app_site-math/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:14:37,180 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:14:37,180 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:14:37,181 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:14:37,181 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:14:37,181 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:14:37,181 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:14:37,181 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:14:37,181 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:14:37,182 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:14:37,182 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,182 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:14:37,182 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:14:37,182 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,182 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:14:37,183 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:14:37,183 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,183 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:14:37,183 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:14:37,183 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:14:37,183 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:14:37,184 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:14:37,184 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,184 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:14:37,184 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:14:37,184 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,184 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7fee2a513ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-math/simulate_job/app_site-math/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:14:37,185 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:14:37,185 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:14:37,185 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:14:37,185 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:14:37,185 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:14:37,185 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:14:37,186 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:14:37,186 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:14:37,186 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:14:37,186 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:14:37,186 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,186 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:14:37,187 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:14:37,187 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:14:37,187 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:14:37,187 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:14:37,188 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:14:37,188 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:14:37,188 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:14:37,188 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:14:37,188 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:14:37,188 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:14:37,189 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:14:37,189 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:14:37,189 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,189 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:14:37,189 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:14:37,190 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 241009.98 examples/s]
[38m2025-05-20 23:14:37,232 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:14:37,233 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:14:37,233 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:14:37,233 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,233 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:14:37,233 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,234 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:14:37,234 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:14:37,234 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:14:37,234 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,234 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:14:37,234 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:14:37,235 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,235 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:14:37,235 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:14:37,235 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,235 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:14:37,235 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:14:37,236 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:14:37,236 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:14:37,236 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:14:37,236 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,236 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:14:37,236 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:14:37,237 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:14:37,237 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,237 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:14:37,237 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:14:37,237 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:14:37,237 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:14:37,238 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:14:37,238 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:14:37,238 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:14:37,238 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:14:37,238 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,238 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:14:37,239 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:14:37,239 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:14:37,239 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:14:37,239 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7fee2a513ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-math/simulate_job/app_site-math/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:14:37,239 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:14:37,239 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:14:37,240 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:14:37,240 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:14:37,240 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:14:37,240 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:14:37,240 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:14:37,240 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:14:37,241 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:14:37,241 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,241 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:14:37,241 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:14:37,241 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,241 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:14:37,242 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:14:37,242 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,242 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:14:37,242 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:14:37,242 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:14:37,242 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:14:37,243 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:14:37,243 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,243 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:14:37,243 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:14:37,243 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:14:37,243 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7fee2a513ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-math/simulate_job/app_site-math/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:14:37,244 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:14:37,244 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:14:37,244 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:14:37,244 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:14:37,244 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:14:37,244 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:14:37,245 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:14:37,245 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:14:37,245 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:14:37,245 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:14:37,245 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,245 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:14:37,246 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:14:37,246 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:14:37,246 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:14:37,246 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:14:37,246 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:14:37,246 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:14:37,247 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:14:37,247 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:14:37,247 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:14:37,247 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:14:37,247 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:14:37,247 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:14:37,248 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:14:37,248 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:14:37,248 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:14:37,248 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 64677.01 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.09it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.76s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.63s/it]
wandb: Currently logged in as: kevinfarhat (allenai-team1). Use `wandb login --relogin` to force relogin
[38m2025-05-20 23:14:44,131 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:14:44,133 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:14:44,134 - ModelDequantizer - INFO - Skipping dequantization for model.model.embed_tokens.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,136 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,136 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,137 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,138 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,139 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,139 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,155 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,155 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,155 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,156 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,156 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,156 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,156 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,158 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,158 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,170 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,170 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,171 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,177 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,177 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,177 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,178 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,178 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,179 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,179 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,183 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,187 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,189 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,192 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,192 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,192 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,204 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,205 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,205 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,211 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,212 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,212 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,212 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,212 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,213 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,213 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,213 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,220 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,220 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,220 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,221 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,221 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,221 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,221 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,222 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,222 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,228 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,229 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,229 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,229 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,230 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,230 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,230 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,230 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,231 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,237 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,237 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,238 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,238 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,238 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,240 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,240 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,240 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,240 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,244 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,244 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,244 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,245 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,245 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,245 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,246 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,247 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,247 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,298 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,299 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,299 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,299 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,300 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,300 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,300 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,300 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,307 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,307 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,307 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,308 - ModelDequantizer - INFO - Skipping dequantization for model.model.norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:14:44,342 - ModelDequantizer - INFO - Dequantized 88/179 params. Before dequantization: 1792.08 MB with meta: 0.00 MB. After dequantization: 3584.16 MB.[0m
[38m2025-05-20 23:14:44,343 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float16', 'model.model.layers.0.self_attn.q_proj.weight': 'float16', 'model.model.layers.0.self_attn.k_proj.weight': 'float16', 'model.model.layers.0.self_attn.v_proj.weight': 'float16', 'model.model.layers.0.self_attn.o_proj.weight': 'float16', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float16', 'model.model.layers.0.mlp.down_proj.weight': 'float16', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float16', 'model.model.layers.1.self_attn.v_proj.weight': 'float16', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float16', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float16', 'model.model.layers.3.self_attn.v_proj.weight': 'float16', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float16', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float16', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float16', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float16', 'model.model.layers.6.self_attn.k_proj.weight': 'float16', 'model.model.layers.6.self_attn.v_proj.weight': 'float16', 'model.model.layers.6.self_attn.o_proj.weight': 'float16', 'model.model.layers.6.self_attn.q_norm.weight': 'float16', 'model.model.layers.6.self_attn.k_norm.weight': 'float16', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float16', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float16', 'model.model.layers.7.self_attn.k_proj.weight': 'float16', 'model.model.layers.7.self_attn.v_proj.weight': 'float16', 'model.model.layers.7.self_attn.o_proj.weight': 'float16', 'model.model.layers.7.self_attn.q_norm.weight': 'float16', 'model.model.layers.7.self_attn.k_norm.weight': 'float16', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float16', 'model.model.layers.7.post_attention_layernorm.weight': 'float16', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.8.self_attn.q_proj.weight': 'float16', 'model.model.layers.8.self_attn.k_proj.weight': 'float16', 'model.model.layers.8.self_attn.v_proj.weight': 'float16', 'model.model.layers.8.self_attn.o_proj.weight': 'float16', 'model.model.layers.8.self_attn.q_norm.weight': 'float16', 'model.model.layers.8.self_attn.k_norm.weight': 'float16', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float16', 'model.model.layers.8.post_attention_layernorm.weight': 'float16', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.9.self_attn.q_proj.weight': 'float16', 'model.model.layers.9.self_attn.k_proj.weight': 'float16', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float16', 'model.model.layers.9.self_attn.q_norm.weight': 'float16', 'model.model.layers.9.self_attn.k_norm.weight': 'float16', 'model.model.layers.9.mlp.gate_proj.weight': 'float16', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float16', 'model.model.layers.9.post_attention_layernorm.weight': 'float16', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.10.self_attn.q_proj.weight': 'float16', 'model.model.layers.10.self_attn.k_proj.weight': 'float16', 'model.model.layers.10.self_attn.v_proj.weight': 'float16', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float16', 'model.model.layers.10.self_attn.k_norm.weight': 'float16', 'model.model.layers.10.mlp.gate_proj.weight': 'float16', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float16', 'model.model.layers.15.self_attn.k_proj.weight': 'float16', 'model.model.layers.15.self_attn.v_proj.weight': 'float16', 'model.model.layers.15.self_attn.o_proj.weight': 'float16', 'model.model.layers.15.self_attn.q_norm.weight': 'float16', 'model.model.layers.15.self_attn.k_norm.weight': 'float16', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float16', 'model.model.layers.15.post_attention_layernorm.weight': 'float16', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float16', 'model.model.norm.weight': 'float16', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:14:44,344 - PTInProcessClientAPIExecutor - INFO - execute for task (train)[0m
[38m2025-05-20 23:14:44,345 - PTInProcessClientAPIExecutor - INFO - send data to peer[0m
[38m2025-05-20 23:14:44,345 - PTInProcessClientAPIExecutor - INFO - sending payload to peer[0m
[38m2025-05-20 23:14:44,346 - PTInProcessClientAPIExecutor - INFO - Waiting for result from peer[0m
wandb: wandb version 0.19.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-math/wandb/run-20250520_231443-math-OLMo-2-0425-1B-1747782882
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pretrain-math-OLMo-2-0425-1B
wandb: ⭐️ View project at https://wandb.ai/allenai-team1/nvflare
wandb: 🚀 View run at https://wandb.ai/allenai-team1/nvflare/runs/math-OLMo-2-0425-1B-1747782882
[38m2025-05-20 23:14:44,592 - TaskScriptRunner - INFO - --- federated round 0 ---[0m
[38m2025-05-20 23:14:47,051 - TaskScriptRunner - INFO - {'loss': 7.8433, 'grad_norm': 8.5625, 'learning_rate': 0.0, 'epoch': 1.0}[0m
[38m2025-05-20 23:14:51,972 - TaskScriptRunner - INFO - 988118026 len text_list[0m
[38m2025-05-20 23:15:01,083 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:15:01,189 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:15:01,204 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:15:01,206 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:15:01,209 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:15:01,210 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:15:01,210 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:15:01,211 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,212 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:15:01,212 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,213 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:15:01,214 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:15:01,214 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:15:01,214 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,215 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:15:01,215 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:15:01,215 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,215 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:15:01,216 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:15:01,216 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,216 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:15:01,217 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:15:01,217 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:15:01,217 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:15:01,218 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:15:01,219 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,219 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:15:01,219 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:15:01,219 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:15:01,220 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,220 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:15:01,220 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:15:01,221 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:15:01,221 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:15:01,222 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:15:01,222 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:15:01,222 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:15:01,223 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:15:01,223 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,223 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:15:01,223 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:15:01,223 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:15:01,224 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:15:01,225 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f79d6854190, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:15:01,225 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:15:01,226 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:15:01,226 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:15:01,226 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:15:01,227 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:15:01,227 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:15:01,228 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:15:01,228 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:15:01,228 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:15:01,228 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,229 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:15:01,229 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:15:01,229 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,230 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:15:01,231 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:15:01,231 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,231 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:15:01,232 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:15:01,233 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:15:01,233 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:15:01,234 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:15:01,234 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,234 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:15:01,235 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:15:01,235 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,235 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f79d6854190, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:15:01,236 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:15:01,236 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:15:01,236 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:15:01,237 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:15:01,237 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:15:01,238 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:15:01,238 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:15:01,239 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:15:01,239 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:15:01,239 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:15:01,240 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,240 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:15:01,240 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:15:01,241 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:15:01,241 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:15:01,242 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:15:01,242 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:15:01,243 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:15:01,243 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:15:01,243 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:15:01,244 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:15:01,244 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:15:01,245 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:15:01,245 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:15:01,246 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,246 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:15:01,247 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:15:01,247 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 139732.97 examples/s]
[38m2025-05-20 23:15:01,321 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:15:01,323 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:15:01,323 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:15:01,324 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,325 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:15:01,326 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,327 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:15:01,327 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:15:01,328 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:15:01,328 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,330 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:15:01,332 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:15:01,333 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,333 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:15:01,336 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:15:01,336 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,337 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:15:01,338 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:15:01,338 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:15:01,339 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:15:01,339 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:15:01,340 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,341 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:15:01,343 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:15:01,344 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:15:01,346 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,347 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:15:01,348 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:15:01,348 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:15:01,349 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:15:01,350 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:15:01,351 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:15:01,351 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:15:01,352 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:15:01,353 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,353 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:15:01,354 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:15:01,355 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:15:01,355 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:15:01,356 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f79d6854190, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:15:01,357 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:15:01,359 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:15:01,360 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:15:01,361 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:15:01,361 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:15:01,362 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:15:01,362 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:15:01,362 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:15:01,362 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:15:01,363 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,363 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:15:01,364 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:15:01,364 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,365 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:15:01,367 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:15:01,368 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,369 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:15:01,369 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:15:01,370 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:15:01,370 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:15:01,371 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:15:01,372 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,373 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:15:01,374 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:15:01,374 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:01,375 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f79d6854190, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:15:01,376 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:15:01,377 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:15:01,377 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:15:01,377 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:15:01,379 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:15:01,380 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:15:01,380 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:15:01,381 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:15:01,381 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:15:01,383 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:15:01,384 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,384 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:15:01,386 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:15:01,387 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:15:01,387 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:15:01,388 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:15:01,388 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:15:01,389 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:15:01,390 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:15:01,391 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:15:01,392 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:15:01,393 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:15:01,394 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:15:01,394 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:15:01,395 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:15:01,396 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:15:01,397 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:15:01,398 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 19687.87 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.43it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.13it/s]
wandb: Currently logged in as: kevinfarhat (allenai-team1). Use `wandb login --relogin` to force relogin
[38m2025-05-20 23:15:04,233 - TaskScriptRunner - INFO - {'train_runtime': 18.8596, 'train_samples_per_second': 0.53, 'train_steps_per_second': 0.053, 'train_loss': 7.843297481536865, 'epoch': 1.0}[0m
[38m2025-05-20 23:15:06,359 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:15:06,360 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
wandb: wandb version 0.19.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/wandb/run-20250520_231503-code-OLMo-2-0425-1B-1747782902
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pretrain-code-OLMo-2-0425-1B
wandb: ⭐️ View project at https://wandb.ai/allenai-team1/nvflare
wandb: 🚀 View run at https://wandb.ai/allenai-team1/nvflare/runs/code-OLMo-2-0425-1B-1747782902
[38m2025-05-20 23:15:08,384 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:15:08,385 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:15:08,385 - ModelDequantizer - INFO - Skipping dequantization for model.model.embed_tokens.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,386 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,386 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,386 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,387 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,387 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,387 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,402 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,403 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,404 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,405 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,405 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,406 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,407 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,409 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,410 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,421 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,422 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,423 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,429 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,429 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,430 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,430 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,431 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,432 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,432 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,435 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,438 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,439 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,441 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,442 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,442 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,455 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,456 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,457 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,462 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,463 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,464 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,464 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,464 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,465 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,465 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,466 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,472 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,472 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,473 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,473 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,474 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,474 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,474 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,475 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,475 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,481 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,482 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,482 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,483 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,483 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,484 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,484 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,485 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,485 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,491 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,491 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,492 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,492 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,493 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,494 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,495 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,495 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,496 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,499 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,500 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,500 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,501 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,501 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,502 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,503 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,503 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,504 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,551 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,552 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,552 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,553 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,553 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,554 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,554 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,554 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,561 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,561 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,562 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,562 - ModelDequantizer - INFO - Skipping dequantization for model.model.norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:15:08,593 - ModelDequantizer - INFO - Dequantized 88/179 params. Before dequantization: 1792.08 MB with meta: 0.00 MB. After dequantization: 3584.16 MB.[0m
[38m2025-05-20 23:15:08,595 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float16', 'model.model.layers.0.self_attn.q_proj.weight': 'float16', 'model.model.layers.0.self_attn.k_proj.weight': 'float16', 'model.model.layers.0.self_attn.v_proj.weight': 'float16', 'model.model.layers.0.self_attn.o_proj.weight': 'float16', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float16', 'model.model.layers.0.mlp.down_proj.weight': 'float16', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float16', 'model.model.layers.1.self_attn.v_proj.weight': 'float16', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float16', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float16', 'model.model.layers.3.self_attn.v_proj.weight': 'float16', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float16', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float16', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float16', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float16', 'model.model.layers.6.self_attn.k_proj.weight': 'float16', 'model.model.layers.6.self_attn.v_proj.weight': 'float16', 'model.model.layers.6.self_attn.o_proj.weight': 'float16', 'model.model.layers.6.self_attn.q_norm.weight': 'float16', 'model.model.layers.6.self_attn.k_norm.weight': 'float16', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float16', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float16', 'model.model.layers.7.self_attn.k_proj.weight': 'float16', 'model.model.layers.7.self_attn.v_proj.weight': 'float16', 'model.model.layers.7.self_attn.o_proj.weight': 'float16', 'model.model.layers.7.self_attn.q_norm.weight': 'float16', 'model.model.layers.7.self_attn.k_norm.weight': 'float16', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float16', 'model.model.layers.7.post_attention_layernorm.weight': 'float16', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.8.self_attn.q_proj.weight': 'float16', 'model.model.layers.8.self_attn.k_proj.weight': 'float16', 'model.model.layers.8.self_attn.v_proj.weight': 'float16', 'model.model.layers.8.self_attn.o_proj.weight': 'float16', 'model.model.layers.8.self_attn.q_norm.weight': 'float16', 'model.model.layers.8.self_attn.k_norm.weight': 'float16', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float16', 'model.model.layers.8.post_attention_layernorm.weight': 'float16', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.9.self_attn.q_proj.weight': 'float16', 'model.model.layers.9.self_attn.k_proj.weight': 'float16', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float16', 'model.model.layers.9.self_attn.q_norm.weight': 'float16', 'model.model.layers.9.self_attn.k_norm.weight': 'float16', 'model.model.layers.9.mlp.gate_proj.weight': 'float16', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float16', 'model.model.layers.9.post_attention_layernorm.weight': 'float16', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.10.self_attn.q_proj.weight': 'float16', 'model.model.layers.10.self_attn.k_proj.weight': 'float16', 'model.model.layers.10.self_attn.v_proj.weight': 'float16', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float16', 'model.model.layers.10.self_attn.k_norm.weight': 'float16', 'model.model.layers.10.mlp.gate_proj.weight': 'float16', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float16', 'model.model.layers.15.self_attn.k_proj.weight': 'float16', 'model.model.layers.15.self_attn.v_proj.weight': 'float16', 'model.model.layers.15.self_attn.o_proj.weight': 'float16', 'model.model.layers.15.self_attn.q_norm.weight': 'float16', 'model.model.layers.15.self_attn.k_norm.weight': 'float16', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float16', 'model.model.layers.15.post_attention_layernorm.weight': 'float16', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float16', 'model.model.norm.weight': 'float16', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:15:08,596 - PTInProcessClientAPIExecutor - INFO - execute for task (train)[0m
[38m2025-05-20 23:15:08,597 - PTInProcessClientAPIExecutor - INFO - send data to peer[0m
[38m2025-05-20 23:15:08,598 - PTInProcessClientAPIExecutor - INFO - sending payload to peer[0m
[38m2025-05-20 23:15:08,599 - PTInProcessClientAPIExecutor - INFO - Waiting for result from peer[0m
[38m2025-05-20 23:15:08,884 - TaskScriptRunner - INFO - --- federated round 0 ---[0m
[38m2025-05-20 23:15:11,474 - TaskScriptRunner - INFO - {'loss': 9.2573, 'grad_norm': 13.625, 'learning_rate': 0.0, 'epoch': 1.0}[0m
[38m2025-05-20 23:15:13,449 - ModelQuantizer - INFO - Quantized 179/179 params. Before quantization: 5664.51 MB. After quantization: 2832.25 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:15:13,451 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
🔔 EVENT RECEIVED: _after_task_data_filter
🔔 EVENT RECEIVED: _before_task_result_filter
[38m2025-05-20 23:15:22,184 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:15:22,185 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:15:26,143 - ModelDequantizer - INFO - Dequantized 179/179 params. Before dequantization: 2832.25 MB with meta: 0.00 MB. After dequantization: 5664.51 MB.[0m
[38m2025-05-20 23:15:26,144 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:15:28,200 - TaskScriptRunner - INFO - {'train_runtime': 18.404, 'train_samples_per_second': 0.543, 'train_steps_per_second': 0.054, 'train_loss': 9.257305145263672, 'epoch': 1.0}[0m
[38m2025-05-20 23:15:30,100 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:15:30,101 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:15:36,727 - ModelQuantizer - INFO - Quantized 179/179 params. Before quantization: 5664.51 MB. After quantization: 2832.25 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:15:36,729 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
🔔 EVENT RECEIVED: _after_task_result_filter
🔔 EVENT RECEIVED: _before_process_submission
🔔 EVENT RECEIVED: _before_contribution_accept
🔔 EVENT RECEIVED: _after_contribution_accept
🔔 EVENT RECEIVED: _after_process_submission
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_result_filter
[38m2025-05-20 23:15:46,983 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:15:46,984 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:15:50,879 - ModelDequantizer - INFO - Dequantized 179/179 params. Before dequantization: 2832.25 MB with meta: 0.00 MB. After dequantization: 5664.51 MB.[0m
[38m2025-05-20 23:15:50,881 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:15:55,494 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:15:55,495 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:15:56,006 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py[0m
🔔 EVENT RECEIVED: _after_task_result_filter
🔔 EVENT RECEIVED: _before_process_submission
🔔 EVENT RECEIVED: _before_contribution_accept
🔔 EVENT RECEIVED: _after_contribution_accept
🔔 EVENT RECEIVED: _after_process_submission
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _before_train_task
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_data_filter
[38m2025-05-20 23:15:56,009 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:15:56,009 - ModelQuantizer - INFO - Already quantized, skip quantization[0m
[38m2025-05-20 23:15:56,117 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:15:56,117 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,117 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:15:56,118 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:15:56,118 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:15:56,118 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,118 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:15:56,118 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:15:56,119 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:15:56,119 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,119 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:15:56,119 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:15:56,119 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:15:56,119 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,120 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:15:56,120 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:15:56,120 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:15:56,120 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:15:56,120 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,121 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:15:56,121 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:15:56,121 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:15:56,121 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,121 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:15:56,121 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:15:56,122 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:15:56,122 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:15:56,122 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,122 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:15:56,122 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:15:56,123 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:15:56,123 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:15:56,123 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,123 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:15:56,123 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:15:56,123 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:15:56,124 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:15:56,124 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,124 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:15:56,124 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:15:56,124 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:15:56,124 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,125 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:15:56,125 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:15:56,125 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:15:56,125 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,125 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:15:56,126 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:15:56,126 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,126 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:15:56,126 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:15:56,126 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,126 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:15:56,127 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:15:56,127 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:15:56,127 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:15:56,127 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:15:56,127 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:15:56,127 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:15:56,128 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:15:56,128 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,128 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:15:56,128 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:15:56,128 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:15:56,128 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:15:56,129 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:15:56,129 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:15:56,129 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:15:56,129 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:15:56,129 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:15:56,129 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:15:56,130 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:15:56,130 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:15:56,130 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:15:56,130 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:15:56,130 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:15:56,130 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:15:56,130 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:15:56,131 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:15:56,131 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:15:56,131 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:15:56,131 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:15:56,131 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:15:56,131 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:15:56,132 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:15:56,132 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:15:56,132 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:15:58,557 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy[0m
[38m2025-05-20 23:15:58,557 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy...[0m
[38m2025-05-20 23:15:58,558 - TaskScriptRunner - INFO - data_array shape: (468993355,)[0m
[38m2025-05-20 23:15:58,558 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:15:58,558 - TaskScriptRunner - INFO - data_array size: 468993355[0m
[38m2025-05-20 23:16:06,746 - TaskScriptRunner - INFO - 468993355 len text_list[0m
[38m2025-05-20 23:16:12,447 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:16:13,447 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:16:13,455 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:16:13,456 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:16:13,458 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:16:13,459 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:16:13,460 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:16:13,461 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,464 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:16:13,467 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,470 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:16:13,472 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:16:13,474 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:16:13,475 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,479 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:16:13,480 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:16:13,481 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,483 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:16:13,485 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:16:13,486 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,488 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:16:13,488 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:16:13,490 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:16:13,492 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:16:13,492 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:16:13,494 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,497 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:16:13,499 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:16:13,500 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:16:13,501 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,503 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:16:13,503 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:16:13,506 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:16:13,507 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:16:13,508 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:16:13,510 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:16:13,512 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:16:13,512 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:16:13,514 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,515 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:16:13,517 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:16:13,518 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:16:13,520 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:16:13,521 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7ffa0534fec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:16:13,524 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:16:13,525 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:16:13,527 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:16:13,528 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:16:13,529 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:16:13,530 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:16:13,532 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:16:13,533 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:16:13,533 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:16:13,535 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,536 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:16:13,536 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:16:13,537 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,538 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:16:13,539 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:16:13,539 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,540 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:16:13,540 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:16:13,541 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:16:13,542 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:16:13,543 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:16:13,543 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,544 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:16:13,547 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:16:13,549 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,550 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7ffa0534fec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:16:13,551 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:16:13,552 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:16:13,553 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:16:13,553 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:16:13,554 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:16:13,554 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:16:13,555 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:16:13,556 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:16:13,557 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:16:13,557 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:16:13,558 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,559 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:16:13,560 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:16:13,562 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:16:13,564 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:16:13,565 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:16:13,565 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:16:13,566 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:16:13,567 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:16:13,568 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:16:13,568 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:16:13,570 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:16:13,572 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:16:13,574 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:16:13,576 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,576 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:16:13,579 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:16:13,580 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 137615.70 examples/s]
[38m2025-05-20 23:16:13,657 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:16:13,658 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:16:13,659 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:16:13,661 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,663 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:16:13,664 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,667 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:16:13,669 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:16:13,671 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:16:13,671 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,672 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:16:13,672 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:16:13,673 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,673 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:16:13,674 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:16:13,675 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,676 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:16:13,676 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:16:13,677 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:16:13,678 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:16:13,679 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:16:13,679 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,680 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:16:13,681 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:16:13,684 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:16:13,685 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,686 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:16:13,686 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:16:13,687 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:16:13,688 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:16:13,688 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:16:13,689 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:16:13,692 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:16:13,695 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:16:13,697 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,698 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:16:13,699 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:16:13,701 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:16:13,702 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:16:13,704 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7ffa0534fec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:16:13,706 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:16:13,707 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:16:13,709 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:16:13,709 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:16:13,711 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:16:13,712 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:16:13,713 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:16:13,715 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:16:13,716 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:16:13,718 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,719 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:16:13,720 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:16:13,721 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,722 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:16:13,723 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:16:13,724 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,726 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:16:13,727 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:16:13,728 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:16:13,730 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:16:13,732 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:16:13,734 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,736 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:16:13,739 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:16:13,740 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:16:13,741 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7ffa0534fec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:16:13,742 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:16:13,743 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:16:13,743 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:16:13,744 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:16:13,744 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:16:13,746 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:16:13,748 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:16:13,750 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:16:13,750 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:16:13,753 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:16:13,755 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,756 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:16:13,759 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:16:13,760 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:16:13,763 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:16:13,764 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:16:13,765 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:16:13,766 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:16:13,767 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:16:13,768 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:16:13,769 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:16:13,769 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:16:13,770 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:16:13,772 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:16:13,772 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:16:13,773 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:16:13,775 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:16:13,777 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 18367.87 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.75s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.64s/it]
wandb: Currently logged in as: kevinfarhat (allenai-team1). Use `wandb login --relogin` to force relogin
[38m2025-05-20 23:16:19,623 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:16:19,625 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:16:19,625 - ModelDequantizer - INFO - Skipping dequantization for model.model.embed_tokens.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,627 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,628 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,629 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,630 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,631 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,631 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,646 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,646 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,646 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,647 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,647 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,647 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,648 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,650 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,650 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,661 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,661 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,662 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,668 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,669 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,670 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,671 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,672 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,673 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,673 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,676 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,679 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,680 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,682 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,682 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,682 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,693 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,694 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,694 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,699 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,700 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,700 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,700 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,701 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,701 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,701 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,702 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,707 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,708 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,708 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,708 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,708 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,709 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,709 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,709 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,710 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,715 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,716 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,716 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,716 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,717 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,717 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,717 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,717 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,718 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,723 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,724 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,724 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,724 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,725 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,726 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,726 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,726 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,727 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,730 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,730 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,730 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,730 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,731 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,731 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,732 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,732 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,733 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,780 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,780 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,781 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,781 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,783 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,783 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,783 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,784 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,790 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,790 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,790 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,791 - ModelDequantizer - INFO - Skipping dequantization for model.model.norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:16:19,823 - ModelDequantizer - INFO - Dequantized 88/179 params. Before dequantization: 1792.08 MB with meta: 0.00 MB. After dequantization: 3584.16 MB.[0m
[38m2025-05-20 23:16:19,824 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float16', 'model.model.layers.0.self_attn.q_proj.weight': 'float16', 'model.model.layers.0.self_attn.k_proj.weight': 'float16', 'model.model.layers.0.self_attn.v_proj.weight': 'float16', 'model.model.layers.0.self_attn.o_proj.weight': 'float16', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float16', 'model.model.layers.0.mlp.down_proj.weight': 'float16', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float16', 'model.model.layers.1.self_attn.v_proj.weight': 'float16', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float16', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float16', 'model.model.layers.3.self_attn.v_proj.weight': 'float16', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float16', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float16', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float16', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float16', 'model.model.layers.6.self_attn.k_proj.weight': 'float16', 'model.model.layers.6.self_attn.v_proj.weight': 'float16', 'model.model.layers.6.self_attn.o_proj.weight': 'float16', 'model.model.layers.6.self_attn.q_norm.weight': 'float16', 'model.model.layers.6.self_attn.k_norm.weight': 'float16', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float16', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float16', 'model.model.layers.7.self_attn.k_proj.weight': 'float16', 'model.model.layers.7.self_attn.v_proj.weight': 'float16', 'model.model.layers.7.self_attn.o_proj.weight': 'float16', 'model.model.layers.7.self_attn.q_norm.weight': 'float16', 'model.model.layers.7.self_attn.k_norm.weight': 'float16', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float16', 'model.model.layers.7.post_attention_layernorm.weight': 'float16', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.8.self_attn.q_proj.weight': 'float16', 'model.model.layers.8.self_attn.k_proj.weight': 'float16', 'model.model.layers.8.self_attn.v_proj.weight': 'float16', 'model.model.layers.8.self_attn.o_proj.weight': 'float16', 'model.model.layers.8.self_attn.q_norm.weight': 'float16', 'model.model.layers.8.self_attn.k_norm.weight': 'float16', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float16', 'model.model.layers.8.post_attention_layernorm.weight': 'float16', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.9.self_attn.q_proj.weight': 'float16', 'model.model.layers.9.self_attn.k_proj.weight': 'float16', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float16', 'model.model.layers.9.self_attn.q_norm.weight': 'float16', 'model.model.layers.9.self_attn.k_norm.weight': 'float16', 'model.model.layers.9.mlp.gate_proj.weight': 'float16', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float16', 'model.model.layers.9.post_attention_layernorm.weight': 'float16', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.10.self_attn.q_proj.weight': 'float16', 'model.model.layers.10.self_attn.k_proj.weight': 'float16', 'model.model.layers.10.self_attn.v_proj.weight': 'float16', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float16', 'model.model.layers.10.self_attn.k_norm.weight': 'float16', 'model.model.layers.10.mlp.gate_proj.weight': 'float16', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float16', 'model.model.layers.15.self_attn.k_proj.weight': 'float16', 'model.model.layers.15.self_attn.v_proj.weight': 'float16', 'model.model.layers.15.self_attn.o_proj.weight': 'float16', 'model.model.layers.15.self_attn.q_norm.weight': 'float16', 'model.model.layers.15.self_attn.k_norm.weight': 'float16', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float16', 'model.model.layers.15.post_attention_layernorm.weight': 'float16', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float16', 'model.model.norm.weight': 'float16', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:16:19,825 - PTInProcessClientAPIExecutor - INFO - execute for task (train)[0m
[38m2025-05-20 23:16:19,826 - PTInProcessClientAPIExecutor - INFO - send data to peer[0m
[38m2025-05-20 23:16:19,826 - PTInProcessClientAPIExecutor - INFO - sending payload to peer[0m
[38m2025-05-20 23:16:19,827 - PTInProcessClientAPIExecutor - INFO - Waiting for result from peer[0m
wandb: wandb version 0.19.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/wandb/run-20250520_231618-lbv1-OLMo-2-0425-1B-1747782978
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pretrain-lbv1-OLMo-2-0425-1B
wandb: ⭐️ View project at https://wandb.ai/allenai-team1/nvflare
wandb: 🚀 View run at https://wandb.ai/allenai-team1/nvflare/runs/lbv1-OLMo-2-0425-1B-1747782978
[38m2025-05-20 23:16:20,065 - TaskScriptRunner - INFO - --- federated round 0 ---[0m
[38m2025-05-20 23:16:22,584 - TaskScriptRunner - INFO - {'loss': 8.2881, 'grad_norm': 7.75, 'learning_rate': 0.0, 'epoch': 1.0}[0m
[38m2025-05-20 23:16:38,959 - TaskScriptRunner - INFO - {'train_runtime': 18.112, 'train_samples_per_second': 0.552, 'train_steps_per_second': 0.055, 'train_loss': 8.28809928894043, 'epoch': 1.0}[0m
[38m2025-05-20 23:16:40,623 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:16:40,624 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:16:47,236 - ModelQuantizer - INFO - Quantized 179/179 params. Before quantization: 5664.51 MB. After quantization: 2832.25 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:16:47,237 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
🔔 EVENT RECEIVED: _after_task_data_filter
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_result_filter
[38m2025-05-20 23:16:57,023 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:16:57,024 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:17:00,998 - ModelDequantizer - INFO - Dequantized 179/179 params. Before dequantization: 2832.25 MB with meta: 0.00 MB. After dequantization: 5664.51 MB.[0m
[38m2025-05-20 23:17:00,999 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
🔔 EVENT RECEIVED: _after_task_result_filter
🔔 EVENT RECEIVED: _before_process_submission
🔔 EVENT RECEIVED: _before_contribution_accept
🔔 EVENT RECEIVED: _after_contribution_accept
🔔 EVENT RECEIVED: _after_process_submission
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_aggregation
[38m2025-05-20 23:17:01,493 - FedAvg - INFO - aggregating 3 update(s) at round 0[0m
[38m2025-05-20 23:17:05,849 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:17:05,850 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:17:06,362 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:17:06,479 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:17:06,480 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,480 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:17:06,480 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:06,480 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:17:06,480 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,481 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:17:06,481 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:06,481 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:17:06,481 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,481 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:17:06,481 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:06,482 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:17:06,482 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,482 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:17:06,482 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:17:06,482 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:06,482 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:17:06,483 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,483 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:17:06,483 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:06,483 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:17:06,483 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,483 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:17:06,484 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:17:06,484 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:06,484 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:17:06,484 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,484 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:17:06,485 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:17:06,485 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:06,485 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:17:06,485 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,485 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:17:06,485 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:17:06,486 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:06,486 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:17:06,486 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,486 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:17:06,486 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:17:06,486 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:17:06,487 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,487 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:17:06,487 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:17:06,487 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:17:06,487 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,487 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:17:06,488 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:17:06,488 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,488 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:17:06,488 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:17:06,488 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,488 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:17:06,489 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:17:06,489 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:17:06,489 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:17:06,489 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:17:06,489 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:17:06,489 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:17:06,490 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:17:06,490 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,490 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:17:06,490 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:06,490 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:17:06,490 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:17:06,491 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:17:06,491 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:17:06,491 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:17:06,491 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:17:06,491 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:17:06,491 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:17:06,491 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:17:06,492 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:17:06,492 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:17:06,492 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:17:06,492 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:17:06,492 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:17:06,492 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:17:06,493 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:17:06,493 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:17:06,493 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:17:06,493 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:17:06,493 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:17:06,493 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:17:06,494 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:17:06,494 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:17:06,494 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _after_aggregation
🔔 EVENT RECEIVED: _before_model_update
🔔 EVENT RECEIVED: _after_model_update
[38m2025-05-20 23:17:11,459 - FedAvg - INFO - Start persist model on server.[0m
[38m2025-05-20 23:17:11,912 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:17:11,912 - ModelQuantizer - INFO - Using model quantizator.[0m
[33m2025-05-20 23:17:16,289 - Cell - WARNING - Receiving unknown req_id='abc4e011-f28a-40cd-8259-54514b5daef6', discarded: 'abc4e011-f28a-40cd-8259-54514b5daef6' headers: {'cn__return_code': 'ok', 'cn__req_id': '', 'cn__msg_type': 'req', 'sm__ri': 'abc4e011-f28a-40cd-8259-54514b5daef6', 'sm__pe': 'fobs', 'cn__payload_len': 405, 'sm__ch': 'return_only', 'sm__tp': 'aux_communication:__sync_runner__', 'sm__sz': 405, 'sm__id': 1750681991950294, 'sm__dt': 2, 'sm__sq': 0, 'sm__os': 0, 'sm__op': True, 'cn__reply_expected': False, 'cn__optional': True, 'cn__secure': False, 'cn__topic': 'sm__DATA', 'cn__channel': 'sm__STREAM', 'cn__destination': 'site-lbv1.simulate_job', 'cn__from': 'server', 'cn__to': 'site-lbv1.simulate_job', 'cn__origin': 'server.simulate_job', 'cn__route': [['server.simulate_job', 1747783036.2887614], ['server', 1747783036.288818], ('site-lbv1.simulate_job', 1747783036.289269)], 'cn__send_time': 1747783036.2888203}[0m
[38m2025-05-20 23:17:16,292 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:17:16,403 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:17:16,403 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,403 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:17:16,403 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:16,404 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:17:16,404 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,404 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:17:16,404 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:16,404 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:17:16,405 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,405 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:17:16,405 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:16,405 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:17:16,405 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,405 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:17:16,406 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:17:16,406 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:16,406 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:17:16,406 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,406 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:17:16,406 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:16,407 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:17:16,407 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,407 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:17:16,407 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:17:16,407 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:16,408 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:17:16,408 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,408 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:17:16,408 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:17:16,408 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:16,408 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:17:16,409 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,409 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:17:16,409 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:17:16,409 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:16,409 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:17:16,410 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,410 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:17:16,410 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:17:16,410 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:17:16,410 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,410 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:17:16,411 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:17:16,411 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:17:16,411 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,411 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:17:16,411 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:17:16,411 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,411 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:17:16,412 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:17:16,412 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,412 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:17:16,412 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:17:16,412 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:17:16,412 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:17:16,413 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:17:16,413 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:17:16,413 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:17:16,413 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:17:16,413 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,413 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:17:16,414 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:16,414 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:17:16,414 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:17:16,414 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:17:16,414 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:17:16,414 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:17:16,415 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:17:16,415 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:17:16,415 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:17:16,415 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:17:16,415 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:17:16,415 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:17:16,415 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:17:16,416 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:17:16,416 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:17:16,416 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:17:16,416 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:17:16,416 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:17:16,416 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:17:16,417 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:17:16,417 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:17:16,417 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:17:16,417 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:17:16,417 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:17:16,417 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:17:18,841 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy[0m
[38m2025-05-20 23:17:18,841 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy...[0m
[38m2025-05-20 23:17:18,842 - TaskScriptRunner - INFO - data_array shape: (468993355,)[0m
[38m2025-05-20 23:17:18,842 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:17:18,842 - TaskScriptRunner - INFO - data_array size: 468993355[0m
[38m2025-05-20 23:17:26,521 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:17:26,522 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:17:26,985 - TaskScriptRunner - INFO - 468993355 len text_list[0m
[38m2025-05-20 23:17:27,476 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:17:27,589 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:17:27,589 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,590 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:17:27,590 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:27,590 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:17:27,590 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,590 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:17:27,590 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:27,591 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:17:27,591 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,591 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:17:27,591 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:27,591 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:17:27,592 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,592 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:17:27,592 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:17:27,592 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:27,592 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:17:27,592 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,593 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:17:27,593 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:27,593 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:17:27,593 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,593 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:17:27,593 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:17:27,594 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:27,594 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:17:27,594 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,594 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:17:27,594 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:17:27,595 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:27,595 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:17:27,595 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,595 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:17:27,595 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:17:27,595 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:27,596 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:17:27,596 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,596 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:17:27,596 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:17:27,596 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:17:27,596 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,597 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:17:27,597 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:17:27,597 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:17:27,597 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,597 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:17:27,597 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:17:27,598 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,598 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:17:27,598 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:17:27,598 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,598 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:17:27,598 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:17:27,599 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:17:27,599 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:17:27,599 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:17:27,599 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:17:27,599 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:17:27,599 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:17:27,600 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,600 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:17:27,600 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:27,600 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:17:27,600 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:17:27,600 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:17:27,600 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:17:27,601 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:17:27,601 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:17:27,601 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:17:27,601 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:17:27,601 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:17:27,601 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:17:27,602 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:17:27,602 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:17:27,602 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:17:27,602 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:17:27,602 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:17:27,602 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:17:27,603 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:17:27,603 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:17:27,603 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:17:27,603 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:17:27,603 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:17:27,603 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:17:27,603 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:17:27,604 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:17:30,227 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy[0m
[38m2025-05-20 23:17:30,227 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy...[0m
[38m2025-05-20 23:17:30,227 - TaskScriptRunner - INFO - data_array shape: (988118026,)[0m
[38m2025-05-20 23:17:30,228 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:17:30,228 - TaskScriptRunner - INFO - data_array size: 988118026[0m
[38m2025-05-20 23:17:31,156 - TaskScriptRunner - INFO - 10000 len text_list[0m
[33m2025-05-20 23:17:31,157 - CoreCell - WARNING - site-lbv1.simulate_job: no waiter for req 03341fb3-7873-4e3a-b0b3-27bb0db7f419 - the reply is too late[0m
[38m2025-05-20 23:17:31,183 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:17:31,187 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:17:31,188 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:17:31,188 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:17:31,189 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:31,189 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:31,189 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,189 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:17:31,189 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,189 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:17:31,190 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:17:31,190 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:17:31,190 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,190 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:31,190 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:31,190 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,191 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:17:31,191 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:17:31,191 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,191 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:17:31,191 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:17:31,191 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:17:31,192 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:31,192 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:31,192 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,192 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:17:31,192 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:31,192 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:17:31,193 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,193 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:17:31,193 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:31,193 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:31,193 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:31,193 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:17:31,194 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:31,194 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:17:31,194 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:17:31,194 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,194 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:17:31,194 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:17:31,195 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:17:31,195 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:17:31,195 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f051da78030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:17:31,195 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:17:31,195 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:17:31,196 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:17:31,196 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:17:31,196 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:17:31,196 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:31,196 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:17:31,196 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:17:31,196 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:31,197 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,197 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:17:31,197 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:17:31,197 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,197 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:31,197 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:17:31,198 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,198 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:17:31,198 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:17:31,198 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:31,198 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:17:31,198 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:17:31,199 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,199 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:31,199 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:17:31,199 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,199 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f051da78030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:17:31,199 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:17:31,200 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:17:31,200 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:17:31,200 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:17:31,200 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:31,200 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:31,200 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:31,201 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:31,201 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:17:31,201 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:17:31,201 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,201 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:17:31,201 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:17:31,202 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:17:31,202 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:17:31,202 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:17:31,202 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:17:31,202 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:17:31,203 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:31,203 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:31,203 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:31,203 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:31,203 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:17:31,203 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:17:31,204 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,204 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:17:31,204 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:17:31,204 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 240744.49 examples/s]
[38m2025-05-20 23:17:31,247 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:17:31,247 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:31,247 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:31,248 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,248 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:17:31,248 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,248 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:17:31,248 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:17:31,248 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:17:31,249 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,249 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:31,249 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:31,249 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,249 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:17:31,249 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:17:31,250 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,250 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:17:31,250 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:17:31,250 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:17:31,250 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:31,250 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:31,251 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,251 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:17:31,251 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:31,251 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:17:31,251 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,251 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:17:31,252 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:31,252 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:31,252 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:31,252 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:17:31,252 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:31,252 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:17:31,253 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:17:31,253 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,253 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:17:31,253 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:17:31,253 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:17:31,254 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:17:31,254 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f051da78030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:17:31,254 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:17:31,254 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:17:31,254 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:17:31,254 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:17:31,255 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:17:31,255 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:31,255 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:17:31,255 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:17:31,255 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:31,255 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,256 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:17:31,256 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:17:31,256 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,256 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:31,256 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:17:31,256 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,257 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:17:31,257 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:17:31,257 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:31,257 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:17:31,257 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:17:31,257 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,258 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:31,258 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:17:31,258 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:31,258 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f051da78030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:17:31,258 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:17:31,258 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:17:31,259 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:17:31,259 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:17:31,259 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:31,259 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:31,259 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:31,259 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:31,260 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:17:31,260 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:17:31,260 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,260 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:17:31,260 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:17:31,260 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:17:31,261 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:17:31,261 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:17:31,261 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:17:31,261 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:17:31,261 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:31,261 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:31,262 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:31,262 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:31,262 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:17:31,262 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:17:31,262 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:31,262 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:17:31,263 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:17:31,263 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 66576.25 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][38m2025-05-20 23:17:37,164 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:17:37,165 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:17:38,105 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:17:38,216 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:17:38,216 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,217 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:17:38,217 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:38,217 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:17:38,217 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,217 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:17:38,218 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:38,218 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:17:38,218 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,218 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:17:38,218 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:38,218 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:17:38,219 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,219 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:17:38,219 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:17:38,219 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:38,219 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:17:38,219 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,220 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:17:38,220 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:38,220 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:17:38,220 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,220 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:17:38,221 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:17:38,221 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:38,221 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:17:38,221 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,221 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:17:38,221 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:17:38,222 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:38,222 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:17:38,222 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,222 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:17:38,222 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:17:38,222 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:17:38,223 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:17:38,223 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,223 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:17:38,223 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:17:38,223 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:17:38,223 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,224 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:17:38,224 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:17:38,224 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:17:38,224 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,224 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:17:38,224 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:17:38,225 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,225 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:17:38,225 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:17:38,225 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,225 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:17:38,225 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:17:38,226 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:17:38,226 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:17:38,226 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:17:38,226 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:17:38,226 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:17:38,226 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:17:38,227 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,227 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:17:38,227 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:38,227 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:17:38,227 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:17:38,227 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:17:38,228 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:17:38,228 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:17:38,228 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:17:38,228 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:17:38,228 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:17:38,228 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:17:38,228 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:17:38,229 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:17:38,229 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:17:38,229 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:17:38,229 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:17:38,229 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:17:38,229 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:17:38,230 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:17:38,230 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:17:38,230 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:17:38,230 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:17:38,230 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:17:38,230 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:17:38,231 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:17:38,231 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:17:40,787 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy[0m
[38m2025-05-20 23:17:40,787 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy...[0m
[38m2025-05-20 23:17:40,788 - TaskScriptRunner - INFO - data_array shape: (468993355,)[0m
[38m2025-05-20 23:17:40,788 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:17:40,788 - TaskScriptRunner - INFO - data_array size: 468993355[0m
[38m2025-05-20 23:17:47,807 - TaskScriptRunner - INFO - 988118026 len text_list[0m
[33m2025-05-20 23:17:47,808 - CoreCell - WARNING - site-code.simulate_job: no waiter for req d35aef1b-39d4-4ed3-92c2-64ddb8b3b742 - the reply is too late[0m
[38m2025-05-20 23:17:49,030 - TaskScriptRunner - INFO - 468993355 len text_list[0m
[38m2025-05-20 23:17:53,221 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:17:53,251 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:17:53,256 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:17:53,257 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:17:53,258 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:17:53,258 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:53,258 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:53,258 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,259 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:17:53,259 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,259 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:17:53,259 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:17:53,259 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:17:53,259 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,260 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:53,260 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:53,260 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,260 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:17:53,260 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:17:53,260 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,261 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:17:53,261 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:17:53,261 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:17:53,261 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:53,261 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:53,261 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,261 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:17:53,262 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:53,262 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:17:53,262 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,262 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:17:53,262 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:53,263 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:53,263 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:53,263 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:17:53,263 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:53,263 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:17:53,263 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:17:53,264 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,264 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:17:53,264 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:17:53,264 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:17:53,264 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:17:53,264 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7fe18bd2bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:17:53,265 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:17:53,265 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:17:53,265 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:17:53,265 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:17:53,265 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:17:53,265 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:53,266 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:17:53,266 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:17:53,266 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:53,266 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,266 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:17:53,266 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:17:53,267 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,267 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:53,267 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:17:53,267 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,267 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:17:53,267 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:17:53,268 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:53,268 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:17:53,268 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:17:53,268 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,268 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:53,268 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:17:53,269 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,269 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7fe18bd2bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:17:53,269 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:17:53,269 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:17:53,269 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:17:53,269 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:17:53,270 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:53,270 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:53,270 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:53,270 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:53,270 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:17:53,270 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:17:53,271 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,271 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:17:53,271 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:17:53,271 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:17:53,271 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:17:53,272 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:17:53,272 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:17:53,272 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:17:53,272 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:53,272 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:53,272 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:53,273 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:53,273 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:17:53,273 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:17:53,273 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,273 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:17:53,273 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:17:53,274 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 219396.34 examples/s]
[38m2025-05-20 23:17:53,322 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:17:53,322 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:53,322 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:53,322 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,322 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:17:53,323 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,323 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:17:53,323 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:17:53,323 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:17:53,323 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,323 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:53,324 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:53,324 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,324 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:17:53,324 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:17:53,324 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,324 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:17:53,325 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:17:53,325 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:17:53,325 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:17:53,325 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:17:53,325 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,325 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:17:53,326 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:53,326 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:17:53,326 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,326 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:17:53,326 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:53,326 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:53,327 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:53,327 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:17:53,327 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:53,327 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:17:53,327 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:17:53,327 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,328 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:17:53,328 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:17:53,328 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:17:53,328 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:17:53,328 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7fe18bd2bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:17:53,328 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:17:53,329 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:17:53,329 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:17:53,329 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:17:53,329 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:17:53,329 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:53,329 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:17:53,330 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:17:53,330 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:17:53,330 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,330 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:17:53,330 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:17:53,330 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,330 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:53,331 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:17:53,331 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,331 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:17:53,331 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:17:53,331 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:53,331 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:17:53,332 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:17:53,332 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,332 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:17:53,332 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:17:53,332 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:17:53,332 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7fe18bd2bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:17:53,333 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:17:53,333 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:17:53,333 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:17:53,333 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:17:53,333 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:53,333 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:53,334 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:53,334 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:53,334 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:17:53,334 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:17:53,334 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,334 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:17:53,335 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:17:53,335 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:17:53,335 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:17:53,335 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:17:53,335 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:17:53,336 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:17:53,336 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:17:53,336 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:53,336 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:17:53,336 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:17:53,336 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:17:53,337 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:17:53,337 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:17:53,337 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:17:53,337 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:17:53,337 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 59091.35 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.15it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  2.15it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.90it/s]
[38m2025-05-20 23:17:54,894 - TaskScriptRunner - INFO - Resuming wandb run with ID: lbv1-OLMo-2-0425-1B-1747782978[0m
[38m2025-05-20 23:18:00,644 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:18:00,734 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:18:00,740 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:18:00,740 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:18:00,741 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:18:00,742 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:00,742 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:00,742 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,742 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:18:00,742 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,742 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:18:00,743 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:18:00,743 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:18:00,743 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,743 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:00,743 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:00,743 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,744 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:18:00,744 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:18:00,744 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,744 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:18:00,744 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:18:00,744 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:18:00,745 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:00,745 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:00,745 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,745 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:18:00,745 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:00,745 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:18:00,746 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,746 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:18:00,746 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:00,746 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:00,746 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:00,746 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:18:00,747 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:00,747 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:18:00,747 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:18:00,747 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,747 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:18:00,748 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:18:00,748 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:18:00,748 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:18:00,748 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f805d13fec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:18:00,748 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:18:00,748 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:18:00,749 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:18:00,749 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:18:00,749 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:18:00,749 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:00,749 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:18:00,749 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:18:00,750 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:00,750 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,750 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:18:00,750 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:18:00,750 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,750 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:00,751 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:18:00,751 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,751 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:18:00,751 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:18:00,751 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:00,752 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:18:00,752 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:18:00,752 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,752 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:00,752 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:18:00,752 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,753 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f805d13fec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:18:00,753 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:18:00,753 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:18:00,753 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:18:00,753 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:18:00,754 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:00,754 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:00,754 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:00,754 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:00,754 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:18:00,754 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:18:00,754 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,755 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:18:00,755 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:18:00,755 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:18:00,755 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:18:00,755 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:18:00,756 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:18:00,756 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:18:00,756 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:00,756 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:00,756 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:00,756 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:00,757 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:18:00,757 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:18:00,757 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,757 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:18:00,757 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:18:00,757 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 223006.62 examples/s]
[38m2025-05-20 23:18:00,804 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:18:00,804 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:00,805 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:00,805 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,805 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:18:00,805 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,805 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:18:00,805 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:18:00,806 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:18:00,806 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,806 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:00,806 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:00,806 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,806 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:18:00,807 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:18:00,807 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,807 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:18:00,807 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:18:00,807 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:18:00,807 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:00,808 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:00,808 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,808 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:18:00,808 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:00,808 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:18:00,808 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,809 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:18:00,809 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:00,809 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:00,809 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:00,809 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:18:00,809 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:00,810 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:18:00,810 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:18:00,810 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,810 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:18:00,810 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:18:00,810 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:18:00,811 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:18:00,811 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f805d13fec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:18:00,811 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:18:00,811 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:18:00,811 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:18:00,811 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:18:00,812 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:18:00,812 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:00,812 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:18:00,812 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:18:00,812 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:00,813 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,813 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:18:00,813 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:18:00,813 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,813 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:00,813 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:18:00,814 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,814 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:18:00,814 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:18:00,814 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:00,814 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:18:00,814 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:18:00,815 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,815 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:00,815 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:18:00,815 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:00,815 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f805d13fec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:18:00,815 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:18:00,816 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:18:00,816 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:18:00,816 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:18:00,816 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:00,816 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:00,816 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:00,817 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:00,817 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:18:00,817 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:18:00,817 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,817 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:18:00,817 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:18:00,818 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:18:00,818 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:18:00,818 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:18:00,818 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:18:00,818 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:18:00,818 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:00,819 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:00,819 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:00,819 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:00,819 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:18:00,819 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:18:00,819 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:00,820 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:18:00,820 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:18:00,820 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 64977.60 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]🔔 EVENT RECEIVED: _before_save_model
📥 SAVE MODEL called
  🔍 Model meta: {'nr_aggregated': 3, 'current_round': 0}
  🔍 Found current round: 0
  ℹ️ Current round: 0
💾 SAVING MODEL FILE: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_0_model
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
✅ SAVED PyTorch model to /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_0_model.pt
🔄 Saving in HF format to /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_0_model_hf
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
  ✅ Copied config.json
  ✅ Copied tokenizer.json
  ✅ Copied tokenizer_config.json
  ✅ Copied vocab.json
  ✅ Copied merges.txt
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
  ✅ Copied special_tokens_map.json
  🔄 Saving model weights
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
  ✅ Saved model weights to /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_0_model_hf/model.safetensors
  📁 HF directory contents: ['config.json', 'vocab.json', 'merges.txt', 'model.safetensors', 'tokenizer.json', 'tokenizer_config.json', 'special_tokens_map.json']
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _after_save_model
[38m2025-05-20 23:18:02,800 - FedAvg - INFO - End persist model on server.[0m
[38m2025-05-20 23:18:02,800 - FedAvg - INFO - Round 1 started.[0m
[38m2025-05-20 23:18:02,800 - FedAvg - INFO - Sampled clients: ['site-code', 'site-math', 'site-lbv1'][0m
[38m2025-05-20 23:18:02,801 - FedAvg - INFO - Sending task train to ['site-code', 'site-math', 'site-lbv1'][0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _before_train_task
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_data_filter
[38m2025-05-20 23:18:02,992 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:18:02,992 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:18:04,556 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:18:04,557 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:18:05,068 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py[0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _before_train_task
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_data_filter
[38m2025-05-20 23:18:05,072 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:18:05,072 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:18:05,072 - ModelQuantizer - INFO - Skipping quantization for model.model.embed_tokens.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,072 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,073 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,073 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,073 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,073 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,074 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,074 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,074 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,074 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,075 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,075 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,075 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,075 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,076 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,076 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,076 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,076 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,076 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,077 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,077 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,077 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,077 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,078 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,078 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,078 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,078 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,078 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,079 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,079 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,079 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,079 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,080 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,080 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,080 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,080 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,081 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,081 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,081 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,081 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,082 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,183 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:18:05,183 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,184 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:18:05,184 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:18:05,184 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:18:05,184 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,184 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:18:05,184 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:18:05,185 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:18:05,185 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,185 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:18:05,185 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:18:05,185 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:18:05,185 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,186 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:18:05,186 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:18:05,186 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:18:05,186 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:18:05,186 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,186 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:18:05,187 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:18:05,187 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:18:05,187 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,187 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:18:05,187 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:18:05,188 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:18:05,188 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:18:05,188 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,188 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:18:05,188 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:18:05,189 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:18:05,189 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:18:05,189 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,189 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:18:05,189 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:18:05,189 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:18:05,190 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:18:05,190 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,190 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:18:05,190 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:18:05,190 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:18:05,190 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,191 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:18:05,191 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:18:05,191 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:18:05,191 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,191 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:18:05,191 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:18:05,192 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,192 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:18:05,192 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:18:05,192 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,192 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:18:05,192 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:18:05,193 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:18:05,193 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:18:05,193 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:18:05,193 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:18:05,193 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:18:05,193 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:18:05,194 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,194 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:18:05,194 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:05,194 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:18:05,194 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:18:05,194 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:18:05,194 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:18:05,195 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:18:05,195 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:18:05,195 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:18:05,195 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:18:05,195 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:18:05,195 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:18:05,196 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:18:05,196 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:18:05,196 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:18:05,196 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:18:05,196 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:18:05,196 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:18:05,197 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:18:05,197 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:18:05,197 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:18:05,197 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:18:05,197 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:18:05,197 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:18:05,197 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:18:05,198 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:18:05,237 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,244 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,244 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,245 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,284 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,284 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,573 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,574 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,643 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,643 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,879 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,880 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,947 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:05,948 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,183 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,184 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,269 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,269 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,503 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,503 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,504 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,564 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,565 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,799 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,799 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,843 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,861 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:06,861 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,096 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,096 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,140 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,168 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,168 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,403 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,403 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,464 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,464 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,465 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,700 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,701 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,753 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy[0m
[38m2025-05-20 23:18:07,754 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy...[0m
[38m2025-05-20 23:18:07,754 - TaskScriptRunner - INFO - data_array shape: (988118026,)[0m
[38m2025-05-20 23:18:07,754 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:18:07,755 - TaskScriptRunner - INFO - data_array size: 988118026[0m
[38m2025-05-20 23:18:07,778 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:07,779 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,020 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,020 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,047 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,090 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,091 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,325 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,325 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,386 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,387 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,387 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,622 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,622 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,700 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,701 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,938 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,938 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:08,938 - ModelQuantizer - INFO - Skipping quantization for model.model.norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:09,890 - ModelQuantizer - INFO - Quantized 136/179 params. Before quantization: 5616.36 MB. After quantization: 2784.11 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:18:09,892 - ModelQuantizer - INFO - Quantized 122/179 params. Before quantization: 4808.40 MB. After quantization: 1976.14 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:18:09,893 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float16', 'model.model.layers.6.self_attn.k_norm.weight': 'float16', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float16', 'model.model.layers.7.self_attn.k_norm.weight': 'float16', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float16', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.8.self_attn.q_proj.weight': 'float16', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float16', 'model.model.layers.8.self_attn.k_norm.weight': 'float16', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float16', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float16', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float16', 'model.model.layers.9.self_attn.k_norm.weight': 'float16', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float16', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float16', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float16', 'model.model.layers.10.self_attn.k_norm.weight': 'float16', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float16', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float16', 'model.model.layers.11.self_attn.q_norm.weight': 'float16', 'model.model.layers.11.self_attn.k_norm.weight': 'float16', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float16', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float16', 'model.model.layers.12.self_attn.k_norm.weight': 'float16', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float16', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float16', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float16', 'model.model.layers.13.self_attn.k_norm.weight': 'float16', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float16', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float16', 'model.model.layers.14.self_attn.q_norm.weight': 'float16', 'model.model.layers.14.self_attn.k_norm.weight': 'float16', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float16', 'model.model.layers.15.self_attn.k_norm.weight': 'float16', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float16', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float16', 'model.model.norm.weight': 'float16', 'model.lm_head.weight': 'float32'} to float16[0m
[38m2025-05-20 23:18:09,894 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float16', 'model.model.layers.0.self_attn.q_proj.weight': 'float16', 'model.model.layers.0.self_attn.k_proj.weight': 'float16', 'model.model.layers.0.self_attn.v_proj.weight': 'float16', 'model.model.layers.0.self_attn.o_proj.weight': 'float16', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float16', 'model.model.layers.0.mlp.up_proj.weight': 'float16', 'model.model.layers.0.mlp.down_proj.weight': 'float16', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float16', 'model.model.layers.1.self_attn.v_proj.weight': 'float16', 'model.model.layers.1.self_attn.o_proj.weight': 'float16', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float16', 'model.model.layers.1.mlp.up_proj.weight': 'float16', 'model.model.layers.1.mlp.down_proj.weight': 'float16', 'model.model.layers.1.post_attention_layernorm.weight': 'float16', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.2.self_attn.q_proj.weight': 'float16', 'model.model.layers.2.self_attn.k_proj.weight': 'float16', 'model.model.layers.2.self_attn.v_proj.weight': 'float16', 'model.model.layers.2.self_attn.o_proj.weight': 'float16', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float16', 'model.model.layers.2.mlp.up_proj.weight': 'float16', 'model.model.layers.2.mlp.down_proj.weight': 'float16', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float16', 'model.model.layers.3.self_attn.v_proj.weight': 'float16', 'model.model.layers.3.self_attn.o_proj.weight': 'float16', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float16', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float16', 'model.model.layers.4.self_attn.k_proj.weight': 'float16', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float16', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
🔔 EVENT RECEIVED: _after_task_data_filter
[38m2025-05-20 23:18:19,733 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:18:19,734 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:18:19,734 - ModelDequantizer - INFO - Skipping dequantization for model.model.embed_tokens.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,735 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,735 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,735 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,736 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,736 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,737 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,737 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,738 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,738 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,738 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,739 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,739 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,740 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,740 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,741 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,741 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,741 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,742 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,742 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,743 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,743 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,743 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,744 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,744 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,745 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,745 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,746 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,746 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,746 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,747 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,747 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,748 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,748 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,748 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,749 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,749 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,750 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,750 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,750 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,751 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,841 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,842 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,843 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,843 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,867 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:19,867 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:20,001 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:20,002 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:20,043 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:20,043 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:20,178 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:20,179 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:20,353 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:20,354 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:21,750 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:21,751 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:22,468 - ModelDequantizer - INFO - Dequantized 122/179 params. Before dequantization: 1976.14 MB with meta: 0.00 MB. After dequantization: 3952.29 MB.[0m
[38m2025-05-20 23:18:22,470 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float16', 'model.model.layers.0.self_attn.q_proj.weight': 'float16', 'model.model.layers.0.self_attn.k_proj.weight': 'float16', 'model.model.layers.0.self_attn.v_proj.weight': 'float16', 'model.model.layers.0.self_attn.o_proj.weight': 'float16', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float16', 'model.model.layers.0.mlp.up_proj.weight': 'float16', 'model.model.layers.0.mlp.down_proj.weight': 'float16', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float16', 'model.model.layers.1.self_attn.v_proj.weight': 'float16', 'model.model.layers.1.self_attn.o_proj.weight': 'float16', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float16', 'model.model.layers.1.mlp.up_proj.weight': 'float16', 'model.model.layers.1.mlp.down_proj.weight': 'float16', 'model.model.layers.1.post_attention_layernorm.weight': 'float16', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.2.self_attn.q_proj.weight': 'float16', 'model.model.layers.2.self_attn.k_proj.weight': 'float16', 'model.model.layers.2.self_attn.v_proj.weight': 'float16', 'model.model.layers.2.self_attn.o_proj.weight': 'float16', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float16', 'model.model.layers.2.mlp.up_proj.weight': 'float16', 'model.model.layers.2.mlp.down_proj.weight': 'float16', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float16', 'model.model.layers.3.self_attn.v_proj.weight': 'float16', 'model.model.layers.3.self_attn.o_proj.weight': 'float16', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float16', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float16', 'model.model.layers.4.self_attn.k_proj.weight': 'float16', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float16', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:18:22,471 - PTInProcessClientAPIExecutor - INFO - execute for task (train)[0m
[38m2025-05-20 23:18:22,472 - PTInProcessClientAPIExecutor - INFO - send data to peer[0m
[38m2025-05-20 23:18:22,473 - PTInProcessClientAPIExecutor - INFO - sending payload to peer[0m
[38m2025-05-20 23:18:22,474 - PTInProcessClientAPIExecutor - INFO - Waiting for result from peer[0m
[38m2025-05-20 23:18:22,596 - TaskScriptRunner - INFO - --- federated round 1 ---[0m
[38m2025-05-20 23:18:24,956 - TaskScriptRunner - INFO - 988118026 len text_list[0m
[38m2025-05-20 23:18:34,566 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:18:34,679 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:18:34,701 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:18:34,705 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:18:34,712 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:18:34,715 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:34,717 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:34,722 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:34,725 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:18:34,727 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:34,729 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:18:34,733 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:18:34,736 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:18:34,739 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:34,741 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:34,743 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:34,745 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:34,747 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:18:34,749 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:18:34,751 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:34,753 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:18:34,756 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:18:34,758 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:18:34,762 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:34,766 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:34,767 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:34,771 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:18:34,773 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:34,776 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:18:34,780 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:34,783 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:18:34,786 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:34,789 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:34,791 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:34,793 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:18:34,795 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:34,797 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:18:34,799 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:18:34,801 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:34,801 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:18:34,803 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:18:34,805 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:18:34,806 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:18:34,810 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f02e9d83ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:18:34,813 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:18:34,816 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:18:34,818 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:18:34,820 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:18:34,824 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:18:34,825 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:34,828 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:18:34,831 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:18:34,835 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:34,839 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:34,841 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:18:34,842 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:18:34,845 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:34,847 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:34,850 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:18:34,852 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:34,853 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:18:34,855 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:18:34,858 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:34,860 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:18:34,863 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:18:34,864 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:34,867 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:34,870 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:18:34,871 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:34,874 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f02e9d83ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:18:34,878 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:18:34,880 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:18:34,883 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:18:34,885 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:18:34,888 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:34,891 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:34,892 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:34,894 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:34,897 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:18:34,901 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:18:34,904 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:34,907 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:18:34,911 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:18:34,912 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:18:34,916 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:18:34,919 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:18:34,922 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:18:34,924 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:18:34,927 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:34,929 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:34,933 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:34,936 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:34,937 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:18:34,941 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:18:34,943 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:34,946 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:18:34,949 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:18:34,951 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 101510.07 examples/s]
[38m2025-05-20 23:18:35,060 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:18:35,063 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:35,066 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:35,069 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:35,072 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:18:35,075 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:35,078 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:18:35,080 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:18:35,084 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:18:35,086 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:35,089 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:35,091 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:35,094 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:35,098 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:18:35,101 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:18:35,102 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:35,105 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:18:35,108 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:18:35,111 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:18:35,114 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:18:35,117 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:18:35,121 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:35,122 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:18:35,125 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:35,128 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:18:35,130 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:35,133 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:18:35,134 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:35,136 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:35,138 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:35,139 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:18:35,141 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:35,142 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:18:35,146 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:18:35,148 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:35,152 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:18:35,154 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:18:35,157 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:18:35,159 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:18:35,161 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f02e9d83ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:18:35,162 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:18:35,164 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:18:35,165 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:18:35,167 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:18:35,167 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:18:35,169 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:35,170 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:18:35,171 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:18:35,173 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:18:35,174 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:35,175 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:18:35,177 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:18:35,179 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:35,179 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:35,180 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:18:35,182 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:35,184 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:18:35,185 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:18:35,187 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:35,189 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:18:35,191 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:18:35,193 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:35,196 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:18:35,197 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:18:35,198 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:18:35,201 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f02e9d83ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:18:35,204 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:18:35,207 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:18:35,210 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:18:35,214 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:18:35,216 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:35,218 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:35,222 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:35,225 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:35,228 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:18:35,229 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:18:35,230 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:35,235 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:18:35,238 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:18:35,241 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:18:35,244 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:18:35,247 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:18:35,251 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:18:35,253 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:18:35,255 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:18:35,258 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:35,261 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:18:35,264 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:18:35,267 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:18:35,270 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:18:35,273 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:18:35,276 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:18:35,279 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:18:35,282 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 15050.07 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.85s/it]
[38m2025-05-20 23:18:39,952 - TaskScriptRunner - INFO - Resuming wandb run with ID: code-OLMo-2-0425-1B-1747782902[0m
wandb: Currently logged in as: kevinfarhat (allenai-team1). Use `wandb login --relogin` to force relogin
[38m2025-05-20 23:18:41,325 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:18:41,326 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:18:41,326 - ModelDequantizer - INFO - Skipping dequantization for model.model.embed_tokens.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,326 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,326 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,327 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,327 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,327 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,327 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,328 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,328 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,328 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,328 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,329 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,329 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,329 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,329 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,330 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,330 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,330 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,330 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,330 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,331 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,331 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,331 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,331 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,332 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,332 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,332 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,332 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,333 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,333 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,333 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,333 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,334 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,334 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,334 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,334 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,334 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,335 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,335 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,335 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,335 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,426 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,428 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,429 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,431 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,455 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,456 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
wandb: wandb version 0.19.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/wandb/run-20250520_231840-code-OLMo-2-0425-1B-1747782902
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run pretrain-code-OLMo-2-0425-1B
wandb: ⭐️ View project at https://wandb.ai/allenai-team1/nvflare
wandb: 🚀 View run at https://wandb.ai/allenai-team1/nvflare/runs/code-OLMo-2-0425-1B-1747782902
[38m2025-05-20 23:18:41,593 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,593 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,635 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,635 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,777 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,778 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,955 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:41,955 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:42,469 - TaskScriptRunner - INFO - RNG state successfully loaded[0m
[38m2025-05-20 23:18:42,984 - TaskScriptRunner - INFO - {'loss': 7.8433, 'grad_norm': 8.5625, 'learning_rate': 0.0005, 'epoch': 2.0}[0m
[38m2025-05-20 23:18:43,365 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:43,365 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:18:44,090 - ModelDequantizer - INFO - Dequantized 122/179 params. Before dequantization: 1976.14 MB with meta: 0.00 MB. After dequantization: 3952.29 MB.[0m
[38m2025-05-20 23:18:44,092 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float16', 'model.model.layers.0.self_attn.q_proj.weight': 'float16', 'model.model.layers.0.self_attn.k_proj.weight': 'float16', 'model.model.layers.0.self_attn.v_proj.weight': 'float16', 'model.model.layers.0.self_attn.o_proj.weight': 'float16', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float16', 'model.model.layers.0.mlp.up_proj.weight': 'float16', 'model.model.layers.0.mlp.down_proj.weight': 'float16', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float16', 'model.model.layers.1.self_attn.v_proj.weight': 'float16', 'model.model.layers.1.self_attn.o_proj.weight': 'float16', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float16', 'model.model.layers.1.mlp.up_proj.weight': 'float16', 'model.model.layers.1.mlp.down_proj.weight': 'float16', 'model.model.layers.1.post_attention_layernorm.weight': 'float16', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.2.self_attn.q_proj.weight': 'float16', 'model.model.layers.2.self_attn.k_proj.weight': 'float16', 'model.model.layers.2.self_attn.v_proj.weight': 'float16', 'model.model.layers.2.self_attn.o_proj.weight': 'float16', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float16', 'model.model.layers.2.mlp.up_proj.weight': 'float16', 'model.model.layers.2.mlp.down_proj.weight': 'float16', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float16', 'model.model.layers.3.self_attn.v_proj.weight': 'float16', 'model.model.layers.3.self_attn.o_proj.weight': 'float16', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float16', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float16', 'model.model.layers.4.self_attn.k_proj.weight': 'float16', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float16', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:18:44,093 - PTInProcessClientAPIExecutor - INFO - execute for task (train)[0m
[38m2025-05-20 23:18:44,094 - PTInProcessClientAPIExecutor - INFO - send data to peer[0m
[38m2025-05-20 23:18:44,094 - PTInProcessClientAPIExecutor - INFO - sending payload to peer[0m
[38m2025-05-20 23:18:44,095 - PTInProcessClientAPIExecutor - INFO - Waiting for result from peer[0m
[38m2025-05-20 23:18:44,237 - TaskScriptRunner - INFO - --- federated round 1 ---[0m
[38m2025-05-20 23:19:01,603 - TaskScriptRunner - INFO - {'train_runtime': 19.1338, 'train_samples_per_second': 1.045, 'train_steps_per_second': 0.105, 'train_loss': 3.9216485023498535, 'epoch': 2.0}[0m
[38m2025-05-20 23:19:03,852 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:19:03,853 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:19:04,167 - TaskScriptRunner - INFO - RNG state successfully loaded[0m
[38m2025-05-20 23:19:05,006 - TaskScriptRunner - INFO - {'loss': 9.2573, 'grad_norm': 13.5625, 'learning_rate': 0.0005, 'epoch': 2.0}[0m
[38m2025-05-20 23:19:10,653 - ModelQuantizer - INFO - Quantized 179/179 params. Before quantization: 5664.51 MB. After quantization: 2832.25 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:19:10,653 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
🔔 EVENT RECEIVED: _after_task_data_filter
🔔 EVENT RECEIVED: _before_task_result_filter
[38m2025-05-20 23:19:20,116 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:19:20,116 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:19:22,379 - TaskScriptRunner - INFO - {'train_runtime': 18.2189, 'train_samples_per_second': 1.098, 'train_steps_per_second': 0.11, 'train_loss': 4.628652572631836, 'epoch': 2.0}[0m
[38m2025-05-20 23:19:23,743 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:19:23,744 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:19:24,077 - ModelDequantizer - INFO - Dequantized 179/179 params. Before dequantization: 2832.25 MB with meta: 0.00 MB. After dequantization: 5664.51 MB.[0m
[38m2025-05-20 23:19:24,078 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
🔔 EVENT RECEIVED: _after_task_result_filter
🔔 EVENT RECEIVED: _before_process_submission
🔔 EVENT RECEIVED: _before_contribution_accept
[38m2025-05-20 23:19:24,079 - IntimeModelSelector - INFO - validation metric nan from client site-math[0m
[38m2025-05-20 23:19:30,587 - ModelQuantizer - INFO - Quantized 179/179 params. Before quantization: 5664.51 MB. After quantization: 2832.25 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:19:30,588 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
🔔 EVENT RECEIVED: _after_contribution_accept
🔔 EVENT RECEIVED: _after_process_submission
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_result_filter
[38m2025-05-20 23:19:39,629 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:19:39,630 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:19:43,512 - ModelDequantizer - INFO - Dequantized 179/179 params. Before dequantization: 2832.25 MB with meta: 0.00 MB. After dequantization: 5664.51 MB.[0m
[38m2025-05-20 23:19:43,514 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
🔔 EVENT RECEIVED: _after_task_result_filter
🔔 EVENT RECEIVED: _before_process_submission
🔔 EVENT RECEIVED: _before_contribution_accept
[38m2025-05-20 23:19:43,515 - IntimeModelSelector - INFO - validation metric nan from client site-code[0m
[38m2025-05-20 23:19:48,175 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:19:48,176 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:19:48,688 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py[0m
🔔 EVENT RECEIVED: _after_contribution_accept
🔔 EVENT RECEIVED: _after_process_submission
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _before_train_task
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_data_filter
[38m2025-05-20 23:19:48,691 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:19:48,692 - ModelQuantizer - INFO - Already quantized, skip quantization[0m
[38m2025-05-20 23:19:48,799 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:19:48,799 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,799 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:19:48,800 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:19:48,800 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:19:48,800 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,800 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:19:48,800 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:19:48,801 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:19:48,801 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,801 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:19:48,801 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:19:48,801 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:19:48,801 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,802 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:19:48,802 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:19:48,802 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:19:48,802 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:19:48,802 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,802 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:19:48,803 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:19:48,803 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:19:48,803 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,803 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:19:48,803 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:19:48,804 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:19:48,804 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:19:48,804 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,804 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:19:48,804 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:19:48,804 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:19:48,805 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:19:48,805 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,805 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:19:48,805 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:19:48,805 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:19:48,806 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:19:48,806 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,806 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:19:48,806 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:19:48,806 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:19:48,806 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,807 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:19:48,807 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:19:48,807 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:19:48,807 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,807 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:19:48,807 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:19:48,807 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,808 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:19:48,808 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:19:48,808 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,808 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:19:48,808 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:19:48,808 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:19:48,809 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:19:48,809 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:19:48,809 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:19:48,809 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:19:48,809 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:19:48,809 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,810 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:19:48,810 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:19:48,810 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:19:48,810 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:19:48,810 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:19:48,810 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:19:48,811 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:19:48,811 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:19:48,811 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:19:48,811 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:19:48,811 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:19:48,811 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:19:48,812 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:19:48,812 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:19:48,812 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:19:48,812 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:19:48,812 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:19:48,812 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:19:48,813 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:19:48,813 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:19:48,813 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:19:48,813 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:19:48,813 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:19:48,813 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:19:48,813 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:19:48,814 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:19:52,578 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy[0m
[38m2025-05-20 23:19:52,580 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy...[0m
[38m2025-05-20 23:19:52,582 - TaskScriptRunner - INFO - data_array shape: (468993355,)[0m
[38m2025-05-20 23:19:52,585 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:19:52,587 - TaskScriptRunner - INFO - data_array size: 468993355[0m
[38m2025-05-20 23:20:00,587 - TaskScriptRunner - INFO - 468993355 len text_list[0m
[38m2025-05-20 23:20:04,205 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:20:04,235 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:20:04,246 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:20:04,248 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:20:04,250 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:20:04,252 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:20:04,253 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:20:04,254 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,256 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:20:04,257 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,258 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:20:04,259 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:20:04,261 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:20:04,261 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,263 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:20:04,264 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:20:04,265 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,266 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:20:04,267 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:20:04,268 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,269 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:20:04,270 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:20:04,271 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:20:04,272 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:20:04,274 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:20:04,275 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,277 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:20:04,278 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:20:04,280 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:20:04,281 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,282 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:20:04,284 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:20:04,285 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:20:04,286 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:20:04,287 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:20:04,288 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:20:04,289 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:20:04,290 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:20:04,292 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,293 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:20:04,294 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:20:04,296 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:20:04,297 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:20:04,298 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f6ea06a0030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:20:04,300 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:20:04,301 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:20:04,303 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:20:04,305 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:20:04,306 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:20:04,307 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:20:04,309 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:20:04,310 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:20:04,311 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:20:04,312 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,313 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:20:04,315 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:20:04,316 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,317 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:20:04,319 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:20:04,319 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,321 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:20:04,322 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:20:04,323 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:20:04,324 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:20:04,326 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:20:04,327 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,328 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:20:04,329 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:20:04,331 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,332 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f6ea06a0030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:20:04,333 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:20:04,335 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:20:04,336 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:20:04,337 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:20:04,338 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:20:04,340 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:20:04,341 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:20:04,342 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:20:04,343 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:20:04,344 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:20:04,346 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,347 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:20:04,348 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:20:04,350 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:20:04,351 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:20:04,353 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:20:04,353 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:20:04,355 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:20:04,356 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:20:04,357 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:20:04,358 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:20:04,359 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:20:04,360 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:20:04,361 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:20:04,363 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,364 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:20:04,365 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:20:04,366 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 166402.62 examples/s]
[38m2025-05-20 23:20:04,430 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:20:04,431 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:20:04,432 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:20:04,433 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,434 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:20:04,435 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,436 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:20:04,437 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:20:04,439 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:20:04,440 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,442 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:20:04,443 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:20:04,445 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,445 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:20:04,447 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:20:04,448 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,449 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:20:04,451 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:20:04,452 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:20:04,453 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:20:04,454 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:20:04,455 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,456 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:20:04,458 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:20:04,459 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:20:04,461 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,462 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:20:04,463 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:20:04,464 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:20:04,465 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:20:04,466 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:20:04,468 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:20:04,469 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:20:04,470 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:20:04,472 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,473 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:20:04,474 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:20:04,476 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:20:04,477 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:20:04,478 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f6ea06a0030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:20:04,479 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:20:04,480 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:20:04,481 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:20:04,482 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:20:04,484 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:20:04,484 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:20:04,486 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:20:04,486 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:20:04,488 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:20:04,489 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,490 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:20:04,491 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:20:04,492 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,493 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:20:04,495 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:20:04,495 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,497 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:20:04,498 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:20:04,500 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:20:04,500 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:20:04,502 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:20:04,503 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,503 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:20:04,505 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:20:04,506 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:20:04,506 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f6ea06a0030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:20:04,508 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:20:04,509 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:20:04,511 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:20:04,512 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:20:04,513 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:20:04,514 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:20:04,515 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:20:04,516 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:20:04,517 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:20:04,518 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:20:04,520 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,521 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:20:04,522 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:20:04,523 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:20:04,525 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:20:04,526 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:20:04,527 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:20:04,528 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:20:04,529 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:20:04,531 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:20:04,532 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:20:04,533 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:20:04,534 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:20:04,535 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:20:04,537 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:20:04,538 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:20:04,540 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:20:04,540 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 22927.21 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.84s/it]
[38m2025-05-20 23:20:08,977 - TaskScriptRunner - INFO - Resuming wandb run with ID: lbv1-OLMo-2-0425-1B-1747782978[0m
[38m2025-05-20 23:20:09,663 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:20:09,663 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:20:09,663 - ModelDequantizer - INFO - Skipping dequantization for model.model.embed_tokens.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,664 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,664 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,664 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,664 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,665 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,665 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,665 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,665 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,666 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,666 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,666 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,666 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,667 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,667 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,667 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,667 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,668 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,668 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,668 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,668 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,668 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,669 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,669 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,669 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,669 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,670 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,670 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,670 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,670 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,671 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.up_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,671 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.mlp.down_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,671 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,671 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,671 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,672 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,672 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,672 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,672 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,673 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,673 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.mlp.gate_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,764 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,765 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,765 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,765 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,788 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,789 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
wandb: Currently logged in as: kevinfarhat (allenai-team1). Use `wandb login --relogin` to force relogin
[38m2025-05-20 23:20:09,926 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,926 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,967 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:09,967 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:10,103 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:10,103 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:10,279 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:10,279 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
wandb: wandb version 0.19.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/wandb/run-20250520_232009-lbv1-OLMo-2-0425-1B-1747782978
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run pretrain-lbv1-OLMo-2-0425-1B
wandb: ⭐️ View project at https://wandb.ai/allenai-team1/nvflare
wandb: 🚀 View run at https://wandb.ai/allenai-team1/nvflare/runs/lbv1-OLMo-2-0425-1B-1747782978
[38m2025-05-20 23:20:11,689 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:11,690 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:20:12,408 - ModelDequantizer - INFO - Dequantized 122/179 params. Before dequantization: 1976.14 MB with meta: 0.00 MB. After dequantization: 3952.29 MB.[0m
[38m2025-05-20 23:20:12,410 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float16', 'model.model.layers.0.self_attn.q_proj.weight': 'float16', 'model.model.layers.0.self_attn.k_proj.weight': 'float16', 'model.model.layers.0.self_attn.v_proj.weight': 'float16', 'model.model.layers.0.self_attn.o_proj.weight': 'float16', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float16', 'model.model.layers.0.mlp.up_proj.weight': 'float16', 'model.model.layers.0.mlp.down_proj.weight': 'float16', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float16', 'model.model.layers.1.self_attn.v_proj.weight': 'float16', 'model.model.layers.1.self_attn.o_proj.weight': 'float16', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float16', 'model.model.layers.1.mlp.up_proj.weight': 'float16', 'model.model.layers.1.mlp.down_proj.weight': 'float16', 'model.model.layers.1.post_attention_layernorm.weight': 'float16', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.2.self_attn.q_proj.weight': 'float16', 'model.model.layers.2.self_attn.k_proj.weight': 'float16', 'model.model.layers.2.self_attn.v_proj.weight': 'float16', 'model.model.layers.2.self_attn.o_proj.weight': 'float16', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float16', 'model.model.layers.2.mlp.up_proj.weight': 'float16', 'model.model.layers.2.mlp.down_proj.weight': 'float16', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float16', 'model.model.layers.3.self_attn.v_proj.weight': 'float16', 'model.model.layers.3.self_attn.o_proj.weight': 'float16', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float16', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float16', 'model.model.layers.4.self_attn.k_proj.weight': 'float16', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float16', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:20:12,411 - PTInProcessClientAPIExecutor - INFO - execute for task (train)[0m
[38m2025-05-20 23:20:12,412 - PTInProcessClientAPIExecutor - INFO - send data to peer[0m
[38m2025-05-20 23:20:12,412 - PTInProcessClientAPIExecutor - INFO - sending payload to peer[0m
[38m2025-05-20 23:20:12,413 - PTInProcessClientAPIExecutor - INFO - Waiting for result from peer[0m
[38m2025-05-20 23:20:12,886 - TaskScriptRunner - INFO - --- federated round 1 ---[0m
[38m2025-05-20 23:20:31,582 - TaskScriptRunner - INFO - RNG state successfully loaded[0m
[38m2025-05-20 23:20:32,454 - TaskScriptRunner - INFO - {'loss': 8.2881, 'grad_norm': 7.75, 'learning_rate': 0.0005, 'epoch': 2.0}[0m
[38m2025-05-20 23:20:50,635 - TaskScriptRunner - INFO - {'train_runtime': 19.0591, 'train_samples_per_second': 1.049, 'train_steps_per_second': 0.105, 'train_loss': 4.144049644470215, 'epoch': 2.0}[0m
[38m2025-05-20 23:20:52,558 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:20:52,559 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:20:58,662 - ModelQuantizer - INFO - Quantized 179/179 params. Before quantization: 5664.51 MB. After quantization: 2832.25 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:20:58,663 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
🔔 EVENT RECEIVED: _after_task_data_filter
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_result_filter
[38m2025-05-20 23:21:09,018 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:21:09,019 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:21:12,947 - ModelDequantizer - INFO - Dequantized 179/179 params. Before dequantization: 2832.25 MB with meta: 0.00 MB. After dequantization: 5664.51 MB.[0m
[38m2025-05-20 23:21:12,948 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
🔔 EVENT RECEIVED: _after_task_result_filter
🔔 EVENT RECEIVED: _before_process_submission
🔔 EVENT RECEIVED: _before_contribution_accept
[38m2025-05-20 23:21:12,949 - IntimeModelSelector - INFO - validation metric nan from client site-lbv1[0m
🔔 EVENT RECEIVED: _after_contribution_accept
🔔 EVENT RECEIVED: _after_process_submission
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_aggregation
[38m2025-05-20 23:21:13,345 - FedAvg - INFO - aggregating 3 update(s) at round 1[0m
[38m2025-05-20 23:21:17,768 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:21:17,769 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:21:18,282 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:21:18,398 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:21:18,398 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,399 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:21:18,399 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:18,399 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:21:18,399 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,399 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:21:18,400 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:18,400 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:21:18,400 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,400 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:21:18,400 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:18,400 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:21:18,401 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,401 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:21:18,401 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:21:18,401 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:18,401 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:21:18,402 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,402 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:21:18,402 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:18,402 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:21:18,402 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,402 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:21:18,403 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:21:18,403 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:18,403 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:21:18,403 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,403 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:21:18,404 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:21:18,404 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:18,404 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:21:18,404 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,404 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:21:18,405 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:21:18,405 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:18,405 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:21:18,405 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,405 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:21:18,405 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:21:18,406 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:21:18,406 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,406 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:21:18,406 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:21:18,406 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:21:18,407 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,407 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:21:18,407 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:21:18,407 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,407 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:21:18,407 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:21:18,408 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,408 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:21:18,408 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:21:18,408 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:21:18,408 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:21:18,408 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:21:18,409 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:21:18,409 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:21:18,409 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:21:18,409 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,409 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:21:18,409 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:18,410 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:21:18,410 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:21:18,410 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:21:18,410 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:21:18,410 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:21:18,410 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:21:18,411 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:21:18,411 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:21:18,411 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:21:18,411 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:21:18,411 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:21:18,411 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:21:18,412 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:21:18,412 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:21:18,412 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:21:18,412 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:21:18,412 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:21:18,412 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:21:18,412 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:21:18,413 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:21:18,413 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:21:18,413 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:21:18,413 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:21:18,413 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _after_aggregation
🔔 EVENT RECEIVED: _before_model_update
🔔 EVENT RECEIVED: _after_model_update
[38m2025-05-20 23:21:23,029 - FedAvg - INFO - Start persist model on server.[0m
[38m2025-05-20 23:21:23,832 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:21:23,832 - ModelQuantizer - INFO - Using model quantizator.[0m
[33m2025-05-20 23:21:27,872 - Cell - WARNING - Receiving unknown req_id='a57ffb7d-2a7c-4c66-889d-1530d0f413b9', discarded: 'a57ffb7d-2a7c-4c66-889d-1530d0f413b9' headers: {'cn__return_code': 'ok', 'cn__req_id': '', 'cn__msg_type': 'req', 'sm__ri': 'a57ffb7d-2a7c-4c66-889d-1530d0f413b9', 'sm__pe': 'fobs', 'cn__payload_len': 405, 'sm__ch': 'return_only', 'sm__tp': 'aux_communication:__sync_runner__', 'sm__sz': 405, 'sm__id': 1750681991950448, 'sm__dt': 2, 'sm__sq': 0, 'sm__os': 0, 'sm__op': True, 'cn__reply_expected': False, 'cn__optional': True, 'cn__secure': False, 'cn__topic': 'sm__DATA', 'cn__channel': 'sm__STREAM', 'cn__destination': 'site-lbv1.simulate_job', 'cn__from': 'server', 'cn__to': 'site-lbv1.simulate_job', 'cn__origin': 'server.simulate_job', 'cn__route': [['server.simulate_job', 1747783287.871006], ['server', 1747783287.8710666], ('site-lbv1.simulate_job', 1747783287.8717964)], 'cn__send_time': 1747783287.8710692}[0m
[38m2025-05-20 23:21:27,875 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:21:27,986 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:21:27,986 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,986 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:21:27,986 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:27,987 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:21:27,987 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,987 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:21:27,987 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:27,987 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:21:27,988 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,988 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:21:27,988 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:27,988 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:21:27,988 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,988 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:21:27,989 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:21:27,989 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:27,989 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:21:27,989 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,989 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:21:27,989 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:27,990 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:21:27,990 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,990 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:21:27,990 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:21:27,990 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:27,991 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:21:27,991 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,991 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:21:27,991 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:21:27,991 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:27,992 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:21:27,992 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,992 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:21:27,992 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:21:27,992 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:27,992 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:21:27,993 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,993 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:21:27,993 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:21:27,993 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:21:27,993 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,994 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:21:27,994 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:21:27,994 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:21:27,994 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,994 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:21:27,994 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:21:27,995 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,995 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:21:27,995 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:21:27,995 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,995 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:21:27,995 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:21:27,996 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:21:27,996 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:21:27,996 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:21:27,996 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:21:27,996 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:21:27,996 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:21:27,997 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,997 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:21:27,997 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:27,997 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:21:27,997 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:21:27,997 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:21:27,998 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:21:27,998 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:21:27,998 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:21:27,998 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:21:27,998 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:21:27,998 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:21:27,999 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:21:27,999 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:21:27,999 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:21:27,999 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:21:27,999 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:21:27,999 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:21:28,000 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:21:28,000 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:21:28,000 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:21:28,000 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:21:28,000 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:21:28,000 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:21:28,001 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:21:28,001 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:21:28,001 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:21:30,406 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy[0m
[38m2025-05-20 23:21:30,407 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy...[0m
[38m2025-05-20 23:21:30,407 - TaskScriptRunner - INFO - data_array shape: (468993355,)[0m
[38m2025-05-20 23:21:30,407 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:21:30,407 - TaskScriptRunner - INFO - data_array size: 468993355[0m
[38m2025-05-20 23:21:38,490 - TaskScriptRunner - INFO - 468993355 len text_list[0m
[38m2025-05-20 23:21:41,986 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:21:42,045 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:21:42,053 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:21:42,054 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:21:42,055 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:21:42,055 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:21:42,056 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:21:42,056 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,056 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:21:42,057 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,057 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:21:42,057 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:21:42,057 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:21:42,058 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,058 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:21:42,058 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:21:42,059 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,059 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:21:42,059 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:21:42,059 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,060 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:21:42,060 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:21:42,060 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:21:42,060 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:21:42,061 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:21:42,061 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,061 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:21:42,062 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:21:42,062 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:21:42,062 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,062 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:21:42,063 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:21:42,063 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:21:42,063 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:21:42,063 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:21:42,064 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:21:42,064 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:21:42,064 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:21:42,064 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,065 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:21:42,065 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:21:42,065 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:21:42,065 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:21:42,066 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f50f7a44030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:21:42,066 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:21:42,066 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:21:42,067 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:21:42,067 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:21:42,067 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:21:42,067 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:21:42,068 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:21:42,068 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:21:42,068 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:21:42,068 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,069 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:21:42,069 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:21:42,069 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,069 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:21:42,070 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:21:42,070 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,070 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:21:42,071 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:21:42,071 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:21:42,071 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:21:42,071 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:21:42,072 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,072 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:21:42,072 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:21:42,072 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,073 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f50f7a44030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:21:42,073 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:21:42,073 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:21:42,074 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:21:42,074 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:21:42,074 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:21:42,074 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:21:42,074 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:21:42,074 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:21:42,075 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:21:42,075 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:21:42,075 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,075 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:21:42,075 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:21:42,075 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:21:42,076 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:21:42,076 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:21:42,076 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:21:42,076 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:21:42,076 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:21:42,077 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:21:42,077 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:21:42,077 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:21:42,077 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:21:42,077 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:21:42,077 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,078 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:21:42,078 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:21:42,078 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 222769.73 examples/s]
[38m2025-05-20 23:21:42,124 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:21:42,125 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:21:42,125 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:21:42,125 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,125 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:21:42,125 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,125 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:21:42,126 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:21:42,126 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:21:42,126 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,126 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:21:42,126 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:21:42,126 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,127 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:21:42,127 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:21:42,127 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,127 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:21:42,127 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:21:42,127 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:21:42,128 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:21:42,128 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:21:42,128 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,128 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:21:42,129 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:21:42,129 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:21:42,129 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,129 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:21:42,130 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:21:42,130 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:21:42,130 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:21:42,130 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:21:42,130 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:21:42,130 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:21:42,131 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:21:42,131 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,131 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:21:42,131 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:21:42,131 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:21:42,131 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:21:42,132 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f50f7a44030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:21:42,132 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:21:42,132 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:21:42,132 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:21:42,132 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:21:42,132 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:21:42,133 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:21:42,133 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:21:42,133 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:21:42,133 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:21:42,133 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,133 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:21:42,134 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:21:42,134 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,134 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:21:42,134 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:21:42,134 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,134 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:21:42,135 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:21:42,135 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:21:42,135 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:21:42,135 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:21:42,135 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,135 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:21:42,136 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:21:42,136 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:42,136 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f50f7a44030, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:21:42,136 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:21:42,136 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:21:42,136 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:21:42,137 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:21:42,137 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:21:42,137 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:21:42,137 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:21:42,137 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:21:42,138 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:21:42,138 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:21:42,138 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,138 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:21:42,138 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:21:42,138 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:21:42,139 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:21:42,139 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:21:42,139 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:21:42,139 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:21:42,139 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:21:42,139 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:21:42,140 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:21:42,140 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:21:42,140 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:21:42,140 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:21:42,140 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:21:42,140 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:21:42,141 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:21:42,141 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 68523.18 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][38m2025-05-20 23:21:45,225 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:21:45,226 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:21:46,608 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:21:46,718 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:21:46,719 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,719 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:21:46,719 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:46,719 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:21:46,719 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,720 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:21:46,720 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:46,720 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:21:46,720 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,720 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:21:46,720 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:46,721 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:21:46,721 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,721 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:21:46,721 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:21:46,721 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:46,722 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:21:46,722 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,722 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:21:46,722 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:46,722 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:21:46,722 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,723 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:21:46,723 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:21:46,723 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:46,723 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:21:46,723 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,724 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:21:46,724 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:21:46,724 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:46,724 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:21:46,724 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,725 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:21:46,725 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:21:46,725 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:21:46,725 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:21:46,725 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,725 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:21:46,726 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:21:46,726 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:21:46,726 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,726 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:21:46,726 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:21:46,727 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:21:46,727 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,727 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:21:46,727 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:21:46,727 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,727 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:21:46,728 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:21:46,728 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,728 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:21:46,728 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:21:46,728 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:21:46,729 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:21:46,729 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:21:46,729 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:21:46,729 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:21:46,729 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:21:46,729 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,730 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:21:46,730 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:21:46,730 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:21:46,730 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:21:46,730 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:21:46,730 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:21:46,731 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:21:46,731 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:21:46,731 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:21:46,731 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:21:46,731 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:21:46,731 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:21:46,732 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:21:46,732 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:21:46,732 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:21:46,732 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:21:46,732 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:21:46,732 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:21:46,733 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:21:46,733 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:21:46,733 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:21:46,733 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:21:46,733 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:21:46,733 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:21:46,734 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:21:46,734 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:21:49,136 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy[0m
[38m2025-05-20 23:21:49,136 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy...[0m
[38m2025-05-20 23:21:49,136 - TaskScriptRunner - INFO - data_array shape: (988118026,)[0m
[38m2025-05-20 23:21:49,137 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:21:49,137 - TaskScriptRunner - INFO - data_array size: 988118026[0m
[38m2025-05-20 23:22:06,471 - TaskScriptRunner - INFO - 988118026 len text_list[0m
[38m2025-05-20 23:22:17,726 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:22:17,815 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:22:17,820 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:22:17,820 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:22:17,821 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:22:17,821 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:17,822 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:17,822 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,822 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:22:17,822 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,822 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:22:17,822 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:22:17,823 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:22:17,823 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,823 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:17,823 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:17,823 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,824 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:22:17,824 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:22:17,824 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,824 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:22:17,824 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:22:17,824 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:22:17,825 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:17,825 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:17,825 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,825 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:22:17,825 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:17,826 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:22:17,826 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,826 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:22:17,826 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:17,826 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:17,826 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:17,827 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:22:17,827 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:17,827 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:22:17,827 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:22:17,827 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,827 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:22:17,828 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:22:17,828 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:22:17,828 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:22:17,828 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7faee06a3ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:22:17,828 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:22:17,829 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:22:17,829 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:22:17,829 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:22:17,829 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:22:17,829 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:17,829 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:22:17,830 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:22:17,830 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:17,830 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,830 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:22:17,830 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:22:17,830 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,831 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:17,831 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:22:17,831 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,831 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:22:17,831 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:22:17,832 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:17,832 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:22:17,832 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:22:17,832 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,832 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:17,832 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:22:17,833 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,833 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7faee06a3ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:22:17,833 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:22:17,833 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:22:17,833 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:22:17,833 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:22:17,834 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:17,834 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:17,834 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:17,834 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:17,834 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:22:17,835 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:22:17,835 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,835 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:22:17,835 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:22:17,835 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:22:17,835 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:22:17,836 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:22:17,836 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:22:17,836 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:22:17,836 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:17,836 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:17,836 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:17,837 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:17,837 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:22:17,837 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:22:17,837 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,837 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:22:17,837 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:22:17,838 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 235830.44 examples/s]
[38m2025-05-20 23:22:17,882 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:22:17,882 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:17,882 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:17,882 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,883 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:22:17,883 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,883 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:22:17,883 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:22:17,883 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:22:17,883 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,884 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:17,884 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:17,884 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,884 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:22:17,884 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:22:17,885 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,885 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:22:17,885 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:22:17,885 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:22:17,885 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:17,885 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:17,886 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,886 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:22:17,886 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:17,886 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:22:17,886 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,887 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:22:17,887 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:17,887 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:17,887 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:17,887 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:22:17,887 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:17,888 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:22:17,888 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:22:17,888 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,888 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:22:17,888 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:22:17,888 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:22:17,889 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:22:17,889 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7faee06a3ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:22:17,889 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:22:17,889 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:22:17,889 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:22:17,890 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:22:17,890 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:22:17,890 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:17,890 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:22:17,890 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:22:17,891 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:17,891 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,891 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:22:17,891 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:22:17,891 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,891 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:17,892 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:22:17,892 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,892 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:22:17,892 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:22:17,892 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:17,892 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:22:17,893 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:22:17,893 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,893 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:17,893 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:22:17,893 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:17,894 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7faee06a3ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:22:17,894 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:22:17,894 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:22:17,894 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:22:17,894 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:22:17,894 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:17,895 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:17,895 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:17,895 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:17,895 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:22:17,895 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:22:17,895 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,896 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:22:17,896 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:22:17,896 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:22:17,896 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:22:17,896 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:22:17,897 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:22:17,897 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:22:17,897 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:17,897 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:17,897 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:17,897 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:17,898 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:22:17,898 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:22:17,898 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:17,898 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:22:17,898 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:22:17,898 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 70921.61 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][38m2025-05-20 23:22:18,452 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:22:18,452 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:22:20,511 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:22:20,622 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:22:20,623 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,623 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:22:20,623 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:22:20,623 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:22:20,623 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,624 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:22:20,624 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:22:20,624 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:22:20,624 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,624 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:22:20,625 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:22:20,625 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:22:20,625 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,625 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:22:20,625 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:22:20,625 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:22:20,626 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:22:20,626 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,626 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:22:20,626 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:22:20,626 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:22:20,626 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,627 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:22:20,627 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:22:20,627 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:22:20,627 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:22:20,627 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,627 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:22:20,628 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:22:20,628 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:22:20,628 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:22:20,628 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,628 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:22:20,629 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:22:20,629 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:22:20,629 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:22:20,629 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,629 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:22:20,629 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:22:20,630 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:22:20,630 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,630 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:22:20,630 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:22:20,630 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:22:20,630 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,631 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:22:20,631 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:22:20,631 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,631 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:22:20,631 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:22:20,631 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,631 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:22:20,632 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:22:20,632 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:22:20,632 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:22:20,632 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:22:20,632 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:22:20,632 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:22:20,633 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:22:20,633 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,633 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:22:20,633 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:20,633 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:22:20,633 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:22:20,634 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:22:20,634 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:22:20,634 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:22:20,634 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:22:20,634 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:22:20,634 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:22:20,634 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:22:20,635 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:22:20,635 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:22:20,635 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:22:20,635 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:22:20,635 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:22:20,635 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:22:20,636 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:22:20,636 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:22:20,636 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:22:20,636 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:22:20,636 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:22:20,636 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:22:20,637 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:22:20,637 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:22:20,637 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
🔔 EVENT RECEIVED: _before_save_model
📥 SAVE MODEL called
  🔍 Model meta: {'nr_aggregated': 3, 'current_round': 1}
  🔍 Found current round: 1
  ℹ️ Current round: 1
💾 SAVING MODEL FILE: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_1_model
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
✅ SAVED PyTorch model to /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_1_model.pt
🔄 Saving in HF format to /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_1_model_hf
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
  ✅ Copied config.json
  ✅ Copied tokenizer.json
  ✅ Copied tokenizer_config.json
  ✅ Copied vocab.json
  ✅ Copied merges.txt
  ✅ Copied special_tokens_map.json
  🔄 Saving model weights
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
  ✅ Saved model weights to /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_1_model_hf/model.safetensors
  📁 HF directory contents: ['config.json', 'vocab.json', 'merges.txt', 'model.safetensors', 'tokenizer.json', 'tokenizer_config.json', 'special_tokens_map.json']
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _after_save_model
[38m2025-05-20 23:22:20,880 - FedAvg - INFO - End persist model on server.[0m
[38m2025-05-20 23:22:20,881 - FedAvg - INFO - Round 2 started.[0m
[38m2025-05-20 23:22:20,881 - FedAvg - INFO - Sampled clients: ['site-code', 'site-math', 'site-lbv1'][0m
[38m2025-05-20 23:22:20,882 - FedAvg - INFO - Sending task train to ['site-code', 'site-math', 'site-lbv1'][0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _before_train_task
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_data_filter
[38m2025-05-20 23:22:21,010 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:22:21,011 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _before_train_task
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_data_filter
[38m2025-05-20 23:22:21,019 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:22:21,019 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:22:22,073 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,074 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,310 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,310 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,311 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,367 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,367 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,606 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,607 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.1.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,607 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,663 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,663 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,901 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,902 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,902 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,960 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:22,960 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,197 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,197 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,197 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,227 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy[0m
[38m2025-05-20 23:22:23,228 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy...[0m
[38m2025-05-20 23:22:23,228 - TaskScriptRunner - INFO - data_array shape: (468993355,)[0m
[38m2025-05-20 23:22:23,228 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:22:23,228 - TaskScriptRunner - INFO - data_array size: 468993355[0m
[38m2025-05-20 23:22:23,255 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,256 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,493 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,493 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.4.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,493 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,494 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,532 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,533 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,770 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,771 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,771 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,829 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:23,829 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,066 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,067 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,067 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,085 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,106 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,106 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,345 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,345 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.7.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,345 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,403 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,403 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,641 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,641 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.8.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,641 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,680 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,681 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,681 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,918 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,919 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.9.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,919 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,977 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:24,977 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,215 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,216 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.10.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,216 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,255 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,256 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,256 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,494 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,495 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.11.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,495 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,553 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,553 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,788 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,789 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.12.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,789 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,846 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:25,847 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,081 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,081 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.13.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,082 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,101 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,119 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,119 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,355 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,356 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,356 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,414 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,414 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,649 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,650 - ModelQuantizer - INFO - Skipping quantization for model.model.layers.15.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:26,650 - ModelQuantizer - INFO - Skipping quantization for model.model.norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:27,586 - ModelQuantizer - INFO - Quantized 179/179 params. Before quantization: 5664.51 MB. After quantization: 2832.25 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:22:27,587 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
🔔 EVENT RECEIVED: _after_task_data_filter
[38m2025-05-20 23:22:27,639 - ModelQuantizer - INFO - Quantized 94/179 params. Before quantization: 5504.25 MB. After quantization: 2672.00 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:22:27,686 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float16', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.2.self_attn.q_proj.weight': 'float16', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float16', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float16', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.5.self_attn.q_proj.weight': 'float16', 'model.model.layers.5.self_attn.k_proj.weight': 'float16', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float16', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float16', 'model.model.layers.6.self_attn.k_norm.weight': 'float16', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float16', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float16', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float16', 'model.model.layers.7.self_attn.k_norm.weight': 'float16', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float16', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.8.self_attn.q_proj.weight': 'float16', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float16', 'model.model.layers.8.self_attn.k_norm.weight': 'float16', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float16', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.9.self_attn.q_proj.weight': 'float16', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float16', 'model.model.layers.9.self_attn.q_norm.weight': 'float16', 'model.model.layers.9.self_attn.k_norm.weight': 'float16', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float16', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.10.self_attn.q_proj.weight': 'float16', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float16', 'model.model.layers.10.self_attn.k_norm.weight': 'float16', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float16', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.11.self_attn.q_proj.weight': 'float16', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float16', 'model.model.layers.11.self_attn.q_norm.weight': 'float16', 'model.model.layers.11.self_attn.k_norm.weight': 'float16', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float16', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.12.self_attn.q_proj.weight': 'float16', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float16', 'model.model.layers.12.self_attn.k_norm.weight': 'float16', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float16', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.13.self_attn.q_proj.weight': 'float16', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float16', 'model.model.layers.13.self_attn.k_norm.weight': 'float16', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float16', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.14.self_attn.q_proj.weight': 'float16', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float16', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float16', 'model.model.layers.14.self_attn.k_norm.weight': 'float16', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float16', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float16', 'model.model.layers.15.self_attn.k_norm.weight': 'float16', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float16', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float16', 'model.model.norm.weight': 'float16', 'model.lm_head.weight': 'float32'} to float16[0m
[38m2025-05-20 23:22:31,400 - TaskScriptRunner - INFO - 468993355 len text_list[0m
[38m2025-05-20 23:22:34,766 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:22:35,768 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:22:35,780 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:22:35,782 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:22:35,784 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:22:35,786 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:35,786 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:35,787 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,788 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:22:35,790 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,792 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:22:35,792 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:22:35,793 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:22:35,793 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,794 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:35,794 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:35,794 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,795 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:22:35,795 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:22:35,796 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,796 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:22:35,797 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:22:35,797 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:22:35,798 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:35,799 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:35,799 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,799 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:22:35,802 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:35,803 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:22:35,803 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,803 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:22:35,804 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:35,804 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:35,805 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:35,805 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:22:35,805 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:35,807 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:22:35,808 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:22:35,810 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,811 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:22:35,812 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:22:35,813 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:22:35,813 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:22:35,814 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f0605c37ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:22:35,816 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:22:35,817 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:22:35,817 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:22:35,817 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:22:35,817 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:22:35,818 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:35,819 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:22:35,820 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:22:35,820 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:35,821 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,822 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:22:35,822 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:22:35,822 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,822 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:35,823 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:22:35,824 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,825 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:22:35,825 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:22:35,826 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:35,827 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:22:35,828 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:22:35,828 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,828 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:35,828 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:22:35,829 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,829 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f0605c37ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:22:35,830 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:22:35,832 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:22:35,832 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:22:35,832 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:22:35,833 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:35,834 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:35,834 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:35,834 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:35,835 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:22:35,835 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:22:35,836 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,838 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:22:35,838 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:22:35,838 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:22:35,839 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:22:35,839 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:22:35,840 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:22:35,840 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:22:35,841 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:35,842 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:35,843 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:35,845 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:35,847 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:22:35,847 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:22:35,847 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,848 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:22:35,848 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:22:35,848 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 145718.86 examples/s]
[38m2025-05-20 23:22:35,920 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:22:35,922 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:35,924 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:35,924 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,926 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:22:35,927 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,927 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:22:35,928 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:22:35,928 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:22:35,928 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,928 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:35,928 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:35,929 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,929 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:22:35,929 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:22:35,930 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,931 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:22:35,931 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:22:35,932 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:22:35,932 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:22:35,932 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:22:35,932 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,932 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:22:35,933 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:35,935 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:22:35,935 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,935 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:22:35,936 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:35,936 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:35,936 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:35,936 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:22:35,937 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:35,937 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:22:35,939 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:22:35,940 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,941 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:22:35,941 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:22:35,941 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:22:35,943 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:22:35,944 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f0605c37ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:22:35,945 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:22:35,946 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:22:35,948 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:22:35,949 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:22:35,949 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:22:35,949 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:35,949 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:22:35,950 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:22:35,950 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:22:35,951 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,952 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:22:35,952 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:22:35,952 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,953 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:35,953 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:22:35,954 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,955 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:22:35,955 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:22:35,955 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:35,955 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:22:35,956 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:22:35,956 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,957 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:22:35,958 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:22:35,959 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:22:35,960 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f0605c37ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:22:35,962 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:22:35,963 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:22:35,963 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:22:35,963 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:22:35,964 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:35,964 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:35,965 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:35,966 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:35,966 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:22:35,967 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:22:35,967 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,967 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:22:35,967 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:22:35,968 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:22:35,968 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:22:35,969 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:22:35,969 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:22:35,970 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:22:35,971 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:22:35,972 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:35,973 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:22:35,973 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:22:35,974 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:22:35,974 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:22:35,976 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:22:35,977 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:22:35,978 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:22:35,979 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 25001.81 examples/s]
[38m2025-05-20 23:22:36,666 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:22:36,666 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][38m2025-05-20 23:22:37,268 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,268 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,374 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,375 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,375 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,418 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,418 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.16it/s][38m2025-05-20 23:22:37,556 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,556 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,557 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,598 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,599 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  2.26it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.97it/s]
[38m2025-05-20 23:22:37,736 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,737 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,737 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,779 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,779 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,917 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,918 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,918 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,950 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:37,950 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,085 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,086 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,086 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,087 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,104 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,105 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,239 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,239 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,240 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,272 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,272 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,406 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,407 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,407 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,419 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,431 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,431 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,565 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,566 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,566 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,598 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,599 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,732 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,733 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,733 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,754 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,754 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,755 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,889 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,890 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,890 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,919 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:38,920 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,053 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,054 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,054 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,078 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,078 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,078 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,212 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,213 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,213 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,242 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,243 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,377 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,378 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,378 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,410 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,411 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,545 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,545 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,546 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,558 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,569 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,570 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,703 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,704 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,704 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,736 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,737 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,871 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,871 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:39,872 - ModelDequantizer - INFO - Skipping dequantization for model.model.norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:40,415 - ModelDequantizer - INFO - Dequantized 94/179 params. Before dequantization: 2672.00 MB with meta: 0.00 MB. After dequantization: 5344.00 MB.[0m
[38m2025-05-20 23:22:40,416 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float16', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.2.self_attn.q_proj.weight': 'float16', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float16', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float16', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.5.self_attn.q_proj.weight': 'float16', 'model.model.layers.5.self_attn.k_proj.weight': 'float16', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float16', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float16', 'model.model.layers.6.self_attn.k_norm.weight': 'float16', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float16', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float16', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float16', 'model.model.layers.7.self_attn.k_norm.weight': 'float16', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float16', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.8.self_attn.q_proj.weight': 'float16', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float16', 'model.model.layers.8.self_attn.k_norm.weight': 'float16', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float16', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.9.self_attn.q_proj.weight': 'float16', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float16', 'model.model.layers.9.self_attn.q_norm.weight': 'float16', 'model.model.layers.9.self_attn.k_norm.weight': 'float16', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float16', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.10.self_attn.q_proj.weight': 'float16', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float16', 'model.model.layers.10.self_attn.k_norm.weight': 'float16', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float16', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.11.self_attn.q_proj.weight': 'float16', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float16', 'model.model.layers.11.self_attn.q_norm.weight': 'float16', 'model.model.layers.11.self_attn.k_norm.weight': 'float16', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float16', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.12.self_attn.q_proj.weight': 'float16', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float16', 'model.model.layers.12.self_attn.k_norm.weight': 'float16', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float16', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.13.self_attn.q_proj.weight': 'float16', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float16', 'model.model.layers.13.self_attn.k_norm.weight': 'float16', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float16', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.14.self_attn.q_proj.weight': 'float16', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float16', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float16', 'model.model.layers.14.self_attn.k_norm.weight': 'float16', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float16', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float16', 'model.model.layers.15.self_attn.k_norm.weight': 'float16', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float16', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float16', 'model.model.norm.weight': 'float16', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:22:40,417 - PTInProcessClientAPIExecutor - INFO - execute for task (train)[0m
[38m2025-05-20 23:22:40,419 - PTInProcessClientAPIExecutor - INFO - send data to peer[0m
[38m2025-05-20 23:22:40,419 - PTInProcessClientAPIExecutor - INFO - sending payload to peer[0m
[38m2025-05-20 23:22:40,420 - PTInProcessClientAPIExecutor - INFO - Waiting for result from peer[0m
[38m2025-05-20 23:22:40,594 - TaskScriptRunner - INFO - Resuming wandb run with ID: lbv1-OLMo-2-0425-1B-1747782978[0m
[38m2025-05-20 23:22:40,746 - TaskScriptRunner - INFO - --- federated round 2 ---[0m
wandb: Currently logged in as: kevinfarhat (allenai-team1). Use `wandb login --relogin` to force relogin
[38m2025-05-20 23:22:41,886 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:22:41,887 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
wandb: wandb version 0.19.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/wandb/run-20250520_232241-lbv1-OLMo-2-0425-1B-1747782978
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run pretrain-lbv1-OLMo-2-0425-1B
wandb: ⭐️ View project at https://wandb.ai/allenai-team1/nvflare
wandb: 🚀 View run at https://wandb.ai/allenai-team1/nvflare/runs/lbv1-OLMo-2-0425-1B-1747782978
[38m2025-05-20 23:22:42,477 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,477 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,613 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,613 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,614 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,646 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,646 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,781 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,782 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,782 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,814 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,815 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,950 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,950 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,953 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,985 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:42,985 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,120 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,121 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,121 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,153 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,154 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,289 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,289 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,290 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,290 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,313 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,314 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,449 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,450 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,450 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,479 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,480 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,615 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,616 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,616 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,628 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,640 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,640 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,775 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,776 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,776 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,808 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,809 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,944 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,944 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,945 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,968 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,969 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:43,969 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,104 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,105 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,105 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,134 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,135 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,270 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,271 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,271 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,294 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,295 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,295 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,431 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,431 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,432 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,461 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,461 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,597 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,597 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,598 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,630 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,630 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,765 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,766 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,767 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,778 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,790 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,791 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,928 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,929 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,929 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,961 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:44,962 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:45,097 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:45,098 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:45,098 - ModelDequantizer - INFO - Skipping dequantization for model.model.norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:22:45,647 - ModelDequantizer - INFO - Dequantized 94/179 params. Before dequantization: 2672.00 MB with meta: 0.00 MB. After dequantization: 5344.00 MB.[0m
[38m2025-05-20 23:22:45,649 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float16', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.2.self_attn.q_proj.weight': 'float16', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float16', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float16', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.5.self_attn.q_proj.weight': 'float16', 'model.model.layers.5.self_attn.k_proj.weight': 'float16', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float16', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float16', 'model.model.layers.6.self_attn.k_norm.weight': 'float16', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float16', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float16', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float16', 'model.model.layers.7.self_attn.k_norm.weight': 'float16', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float16', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.8.self_attn.q_proj.weight': 'float16', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float16', 'model.model.layers.8.self_attn.k_norm.weight': 'float16', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float16', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.9.self_attn.q_proj.weight': 'float16', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float16', 'model.model.layers.9.self_attn.q_norm.weight': 'float16', 'model.model.layers.9.self_attn.k_norm.weight': 'float16', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float16', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.10.self_attn.q_proj.weight': 'float16', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float16', 'model.model.layers.10.self_attn.k_norm.weight': 'float16', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float16', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.11.self_attn.q_proj.weight': 'float16', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float16', 'model.model.layers.11.self_attn.q_norm.weight': 'float16', 'model.model.layers.11.self_attn.k_norm.weight': 'float16', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float16', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.12.self_attn.q_proj.weight': 'float16', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float16', 'model.model.layers.12.self_attn.k_norm.weight': 'float16', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float16', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.13.self_attn.q_proj.weight': 'float16', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float16', 'model.model.layers.13.self_attn.k_norm.weight': 'float16', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float16', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.14.self_attn.q_proj.weight': 'float16', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float16', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float16', 'model.model.layers.14.self_attn.k_norm.weight': 'float16', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float16', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float16', 'model.model.layers.15.self_attn.k_norm.weight': 'float16', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float16', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float16', 'model.model.norm.weight': 'float16', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:22:45,650 - PTInProcessClientAPIExecutor - INFO - execute for task (train)[0m
[38m2025-05-20 23:22:45,651 - PTInProcessClientAPIExecutor - INFO - send data to peer[0m
[38m2025-05-20 23:22:45,651 - PTInProcessClientAPIExecutor - INFO - sending payload to peer[0m
[38m2025-05-20 23:22:45,652 - PTInProcessClientAPIExecutor - INFO - Waiting for result from peer[0m
[38m2025-05-20 23:22:45,735 - TaskScriptRunner - INFO - --- federated round 2 ---[0m
[38m2025-05-20 23:22:59,628 - TaskScriptRunner - INFO - RNG state successfully loaded[0m
[38m2025-05-20 23:23:00,182 - TaskScriptRunner - INFO - {'loss': 8.0056, 'grad_norm': 19.75, 'learning_rate': 0.0, 'epoch': 3.0}[0m
[38m2025-05-20 23:23:11,246 - TaskScriptRunner - INFO - RNG state successfully loaded[0m
[38m2025-05-20 23:23:12,053 - TaskScriptRunner - INFO - {'loss': 8.3632, 'grad_norm': 14.375, 'learning_rate': 0.0, 'epoch': 3.0}[0m
[38m2025-05-20 23:23:18,822 - TaskScriptRunner - INFO - {'train_runtime': 19.1945, 'train_samples_per_second': 1.563, 'train_steps_per_second': 0.156, 'train_loss': 2.6685256958007812, 'epoch': 3.0}[0m
[38m2025-05-20 23:23:20,395 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:23:20,396 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:23:26,766 - ModelQuantizer - INFO - Quantized 179/179 params. Before quantization: 5664.51 MB. After quantization: 2832.25 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:23:26,766 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
[38m2025-05-20 23:23:31,555 - TaskScriptRunner - INFO - {'train_runtime': 20.3152, 'train_samples_per_second': 1.477, 'train_steps_per_second': 0.148, 'train_loss': 2.787739117940267, 'epoch': 3.0}[0m
[38m2025-05-20 23:23:33,417 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:23:33,418 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
🔔 EVENT RECEIVED: _after_task_data_filter
🔔 EVENT RECEIVED: _before_task_result_filter
[38m2025-05-20 23:23:36,174 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:23:36,175 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:23:39,973 - ModelQuantizer - INFO - Quantized 179/179 params. Before quantization: 5664.51 MB. After quantization: 2832.25 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:23:39,974 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
[38m2025-05-20 23:23:40,093 - ModelDequantizer - INFO - Dequantized 179/179 params. Before dequantization: 2832.25 MB with meta: 0.00 MB. After dequantization: 5664.51 MB.[0m
[38m2025-05-20 23:23:40,095 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
🔔 EVENT RECEIVED: _after_task_result_filter
🔔 EVENT RECEIVED: _before_process_submission
🔔 EVENT RECEIVED: _before_contribution_accept
[38m2025-05-20 23:23:40,096 - IntimeModelSelector - INFO - validation metric nan from client site-math[0m
🔔 EVENT RECEIVED: _after_contribution_accept
🔔 EVENT RECEIVED: _after_process_submission
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_result_filter
[38m2025-05-20 23:23:50,069 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:23:50,069 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:23:54,013 - ModelDequantizer - INFO - Dequantized 179/179 params. Before dequantization: 2832.25 MB with meta: 0.00 MB. After dequantization: 5664.51 MB.[0m
[38m2025-05-20 23:23:54,015 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
🔔 EVENT RECEIVED: _after_task_result_filter
🔔 EVENT RECEIVED: _before_process_submission
🔔 EVENT RECEIVED: _before_contribution_accept
[38m2025-05-20 23:23:54,016 - IntimeModelSelector - INFO - validation metric nan from client site-lbv1[0m
[38m2025-05-20 23:23:58,712 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:23:58,712 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:23:59,224 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py[0m
🔔 EVENT RECEIVED: _after_contribution_accept
🔔 EVENT RECEIVED: _after_process_submission
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _before_train_task
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_data_filter
[38m2025-05-20 23:23:59,227 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:23:59,228 - ModelQuantizer - INFO - Already quantized, skip quantization[0m
[38m2025-05-20 23:23:59,339 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:23:59,339 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,339 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:23:59,339 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:23:59,339 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:23:59,340 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,340 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:23:59,340 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:23:59,340 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:23:59,340 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,341 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:23:59,341 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:23:59,341 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:23:59,341 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,341 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:23:59,341 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:23:59,342 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:23:59,342 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:23:59,342 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,342 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:23:59,342 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:23:59,342 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:23:59,343 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,343 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:23:59,343 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:23:59,343 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:23:59,343 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:23:59,344 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,344 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:23:59,344 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:23:59,344 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:23:59,344 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:23:59,344 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,345 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:23:59,345 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:23:59,345 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:23:59,345 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:23:59,345 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,346 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:23:59,346 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:23:59,346 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:23:59,346 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,346 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:23:59,346 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:23:59,346 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:23:59,347 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,347 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:23:59,347 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:23:59,347 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,347 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:23:59,347 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:23:59,348 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,348 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:23:59,348 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:23:59,348 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:23:59,348 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:23:59,348 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:23:59,349 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:23:59,349 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:23:59,349 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:23:59,349 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,349 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:23:59,349 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:23:59,350 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:23:59,350 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:23:59,350 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:23:59,350 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:23:59,350 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:23:59,350 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:23:59,351 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:23:59,351 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:23:59,351 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:23:59,351 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:23:59,351 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:23:59,351 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:23:59,351 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:23:59,352 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:23:59,352 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:23:59,352 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:23:59,352 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:23:59,352 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:23:59,352 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:23:59,353 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:23:59,353 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:23:59,353 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:23:59,353 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:23:59,353 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:24:03,288 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy[0m
[38m2025-05-20 23:24:03,291 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy...[0m
[38m2025-05-20 23:24:03,294 - TaskScriptRunner - INFO - data_array shape: (988118026,)[0m
[38m2025-05-20 23:24:03,295 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:24:03,297 - TaskScriptRunner - INFO - data_array size: 988118026[0m
[38m2025-05-20 23:24:20,432 - TaskScriptRunner - INFO - 988118026 len text_list[0m
[38m2025-05-20 23:24:30,098 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:24:30,209 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:24:30,228 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:24:30,232 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:24:30,235 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:24:30,236 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:24:30,238 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:24:30,242 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,244 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:24:30,247 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,250 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:24:30,254 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:24:30,257 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:24:30,259 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,264 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:24:30,267 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:24:30,271 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,274 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:24:30,276 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:24:30,279 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,282 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:24:30,286 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:24:30,290 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:24:30,293 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:24:30,295 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:24:30,298 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,299 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:24:30,303 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:24:30,305 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:24:30,310 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,314 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:24:30,317 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:24:30,320 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:24:30,323 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:24:30,327 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:24:30,330 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:24:30,335 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:24:30,336 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:24:30,340 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,343 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:24:30,349 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:24:30,352 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:24:30,356 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:24:30,360 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7fe0cfd3bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:24:30,362 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:24:30,364 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:24:30,370 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:24:30,372 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:24:30,374 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:24:30,377 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:24:30,379 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:24:30,382 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:24:30,384 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:24:30,387 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,389 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:24:30,392 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:24:30,395 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,399 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:24:30,401 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:24:30,403 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,406 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:24:30,410 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:24:30,413 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:24:30,417 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:24:30,418 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:24:30,420 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,424 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:24:30,428 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:24:30,432 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,436 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7fe0cfd3bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:24:30,439 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:24:30,442 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:24:30,446 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:24:30,448 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:24:30,451 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:24:30,455 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:24:30,459 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:24:30,461 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:24:30,465 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:24:30,470 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:24:30,473 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,476 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:24:30,478 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:24:30,482 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:24:30,485 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:24:30,487 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:24:30,489 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:24:30,492 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:24:30,495 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:24:30,499 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:24:30,502 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:24:30,504 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:24:30,509 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:24:30,513 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:24:30,517 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,519 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:24:30,522 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:24:30,524 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 91249.85 examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 86888.56 examples/s]
[38m2025-05-20 23:24:30,646 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:24:30,648 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:24:30,651 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:24:30,654 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,657 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:24:30,661 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,663 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:24:30,665 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:24:30,668 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:24:30,670 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,673 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:24:30,674 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:24:30,677 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,679 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:24:30,680 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:24:30,682 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,684 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:24:30,687 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:24:30,689 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:24:30,694 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:24:30,698 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:24:30,701 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,703 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:24:30,707 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:24:30,709 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:24:30,711 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,712 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:24:30,713 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:24:30,716 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:24:30,718 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:24:30,722 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:24:30,725 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:24:30,728 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:24:30,733 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:24:30,735 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,737 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:24:30,739 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:24:30,742 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:24:30,744 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:24:30,747 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7fe0cfd3bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:24:30,749 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:24:30,752 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:24:30,754 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:24:30,759 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:24:30,761 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:24:30,763 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:24:30,765 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:24:30,768 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:24:30,770 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:24:30,773 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,775 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:24:30,779 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:24:30,782 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,786 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:24:30,790 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:24:30,794 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,797 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:24:30,799 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:24:30,802 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:24:30,805 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:24:30,807 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:24:30,812 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,815 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:24:30,817 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:24:30,819 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:24:30,821 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7fe0cfd3bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:24:30,825 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:24:30,826 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:24:30,829 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:24:30,834 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:24:30,836 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:24:30,838 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:24:30,842 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:24:30,845 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:24:30,849 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:24:30,851 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:24:30,854 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,857 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:24:30,860 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:24:30,864 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:24:30,866 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:24:30,869 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:24:30,872 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:24:30,876 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:24:30,878 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:24:30,881 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:24:30,885 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:24:30,889 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:24:30,890 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:24:30,892 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:24:30,894 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:24:30,898 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:24:30,901 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:24:30,905 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 13605.06 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.01s/it]
[38m2025-05-20 23:24:36,040 - TaskScriptRunner - INFO - Resuming wandb run with ID: code-OLMo-2-0425-1B-1747782902[0m
[38m2025-05-20 23:24:36,865 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:24:36,872 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
wandb: Currently logged in as: kevinfarhat (allenai-team1). Use `wandb login --relogin` to force relogin
[38m2025-05-20 23:24:37,459 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,460 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,594 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,594 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.0.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,595 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,627 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,627 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,761 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,761 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.1.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,762 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
wandb: wandb version 0.19.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/wandb/run-20250520_232437-code-OLMo-2-0425-1B-1747782902
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run pretrain-code-OLMo-2-0425-1B
wandb: ⭐️ View project at https://wandb.ai/allenai-team1/nvflare
wandb: 🚀 View run at https://wandb.ai/allenai-team1/nvflare/runs/code-OLMo-2-0425-1B-1747782902
[38m2025-05-20 23:24:37,794 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,794 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,930 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,931 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.2.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,932 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,964 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:37,966 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,101 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,101 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.3.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,102 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,135 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,135 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,272 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,273 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.4.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,273 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,274 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,297 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,298 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,436 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,437 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.5.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,437 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,468 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,468 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,605 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,606 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.6.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,606 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,618 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,630 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,631 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,768 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,769 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.7.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,769 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,802 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,802 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,941 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,941 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.8.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,942 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,966 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,966 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:38,967 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,104 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,105 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.9.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,105 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,135 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,136 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,274 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,274 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.10.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,275 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,299 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.o_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,299 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,300 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,437 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,437 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.11.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,438 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,468 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,468 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,605 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,606 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.12.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,606 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,639 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,640 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,777 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,777 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.13.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,777 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,790 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.v_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,802 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,803 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,940 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,941 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.14.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,941 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_proj.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,974 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.q_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:39,975 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.self_attn.k_norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:40,112 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_attention_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:40,112 - ModelDequantizer - INFO - Skipping dequantization for model.model.layers.15.post_feedforward_layernorm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:40,113 - ModelDequantizer - INFO - Skipping dequantization for model.model.norm.weight, quantization bit float16 >= source data bit float16[0m
[38m2025-05-20 23:24:40,666 - ModelDequantizer - INFO - Dequantized 94/179 params. Before dequantization: 2672.00 MB with meta: 0.00 MB. After dequantization: 5344.00 MB.[0m
[38m2025-05-20 23:24:40,668 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float16', 'model.model.layers.0.self_attn.k_norm.weight': 'float16', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float16', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.1.self_attn.q_proj.weight': 'float16', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float16', 'model.model.layers.1.self_attn.k_norm.weight': 'float16', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float16', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.2.self_attn.q_proj.weight': 'float16', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float16', 'model.model.layers.2.self_attn.k_norm.weight': 'float16', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float16', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.3.self_attn.q_proj.weight': 'float16', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float16', 'model.model.layers.3.self_attn.k_norm.weight': 'float16', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float16', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.4.self_attn.q_proj.weight': 'float16', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float16', 'model.model.layers.4.self_attn.k_norm.weight': 'float16', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float16', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.5.self_attn.q_proj.weight': 'float16', 'model.model.layers.5.self_attn.k_proj.weight': 'float16', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float16', 'model.model.layers.5.self_attn.k_norm.weight': 'float16', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float16', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.6.self_attn.q_proj.weight': 'float16', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float16', 'model.model.layers.6.self_attn.k_norm.weight': 'float16', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float16', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.7.self_attn.q_proj.weight': 'float16', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float16', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float16', 'model.model.layers.7.self_attn.k_norm.weight': 'float16', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float16', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.8.self_attn.q_proj.weight': 'float16', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float16', 'model.model.layers.8.self_attn.k_norm.weight': 'float16', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float16', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.9.self_attn.q_proj.weight': 'float16', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float16', 'model.model.layers.9.self_attn.q_norm.weight': 'float16', 'model.model.layers.9.self_attn.k_norm.weight': 'float16', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float16', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.10.self_attn.q_proj.weight': 'float16', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float16', 'model.model.layers.10.self_attn.k_norm.weight': 'float16', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float16', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.11.self_attn.q_proj.weight': 'float16', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float16', 'model.model.layers.11.self_attn.q_norm.weight': 'float16', 'model.model.layers.11.self_attn.k_norm.weight': 'float16', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float16', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.12.self_attn.q_proj.weight': 'float16', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float16', 'model.model.layers.12.self_attn.k_norm.weight': 'float16', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float16', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.13.self_attn.q_proj.weight': 'float16', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float16', 'model.model.layers.13.self_attn.k_norm.weight': 'float16', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float16', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.14.self_attn.q_proj.weight': 'float16', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float16', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float16', 'model.model.layers.14.self_attn.k_norm.weight': 'float16', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float16', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float16', 'model.model.layers.15.self_attn.q_proj.weight': 'float16', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float16', 'model.model.layers.15.self_attn.k_norm.weight': 'float16', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float16', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float16', 'model.model.norm.weight': 'float16', 'model.lm_head.weight': 'float32'}[0m
[38m2025-05-20 23:24:40,669 - PTInProcessClientAPIExecutor - INFO - execute for task (train)[0m
[38m2025-05-20 23:24:40,671 - PTInProcessClientAPIExecutor - INFO - send data to peer[0m
[38m2025-05-20 23:24:40,672 - PTInProcessClientAPIExecutor - INFO - sending payload to peer[0m
[38m2025-05-20 23:24:40,673 - PTInProcessClientAPIExecutor - INFO - Waiting for result from peer[0m
[38m2025-05-20 23:24:40,997 - TaskScriptRunner - INFO - --- federated round 2 ---[0m
[38m2025-05-20 23:25:01,405 - TaskScriptRunner - INFO - RNG state successfully loaded[0m
[38m2025-05-20 23:25:02,259 - TaskScriptRunner - INFO - {'loss': 10.4345, 'grad_norm': 17.0, 'learning_rate': 0.0, 'epoch': 3.0}[0m
🔔 EVENT RECEIVED: _after_task_data_filter
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
[38m2025-05-20 23:25:22,616 - TaskScriptRunner - INFO - {'train_runtime': 21.2177, 'train_samples_per_second': 1.414, 'train_steps_per_second': 0.141, 'train_loss': 3.4781723022460938, 'epoch': 3.0}[0m
[38m2025-05-20 23:25:24,308 - ModelQuantizer - INFO - Running quantization...[0m
[38m2025-05-20 23:25:24,309 - ModelQuantizer - INFO - Running quantization on 179 variables[0m
[38m2025-05-20 23:25:30,956 - ModelQuantizer - INFO - Quantized 179/179 params. Before quantization: 5664.51 MB. After quantization: 2832.25 MB with meta: 0.00 MB.[0m
[38m2025-05-20 23:25:30,958 - ModelQuantizer - INFO - Quantized from {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'} to float16[0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_task_result_filter
[38m2025-05-20 23:25:39,968 - ModelDequantizer - INFO - Running dequantization...[0m
[38m2025-05-20 23:25:39,968 - ModelDequantizer - INFO - Running dequantization on 179 variables[0m
[38m2025-05-20 23:25:43,897 - ModelDequantizer - INFO - Dequantized 179/179 params. Before dequantization: 2832.25 MB with meta: 0.00 MB. After dequantization: 5664.51 MB.[0m
[38m2025-05-20 23:25:43,898 - ModelDequantizer - INFO - Dequantized back to {'model.model.embed_tokens.weight': 'float32', 'model.model.layers.0.self_attn.q_proj.weight': 'float32', 'model.model.layers.0.self_attn.k_proj.weight': 'float32', 'model.model.layers.0.self_attn.v_proj.weight': 'float32', 'model.model.layers.0.self_attn.o_proj.weight': 'float32', 'model.model.layers.0.self_attn.q_norm.weight': 'float32', 'model.model.layers.0.self_attn.k_norm.weight': 'float32', 'model.model.layers.0.mlp.gate_proj.weight': 'float32', 'model.model.layers.0.mlp.up_proj.weight': 'float32', 'model.model.layers.0.mlp.down_proj.weight': 'float32', 'model.model.layers.0.post_attention_layernorm.weight': 'float32', 'model.model.layers.0.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.1.self_attn.q_proj.weight': 'float32', 'model.model.layers.1.self_attn.k_proj.weight': 'float32', 'model.model.layers.1.self_attn.v_proj.weight': 'float32', 'model.model.layers.1.self_attn.o_proj.weight': 'float32', 'model.model.layers.1.self_attn.q_norm.weight': 'float32', 'model.model.layers.1.self_attn.k_norm.weight': 'float32', 'model.model.layers.1.mlp.gate_proj.weight': 'float32', 'model.model.layers.1.mlp.up_proj.weight': 'float32', 'model.model.layers.1.mlp.down_proj.weight': 'float32', 'model.model.layers.1.post_attention_layernorm.weight': 'float32', 'model.model.layers.1.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.2.self_attn.q_proj.weight': 'float32', 'model.model.layers.2.self_attn.k_proj.weight': 'float32', 'model.model.layers.2.self_attn.v_proj.weight': 'float32', 'model.model.layers.2.self_attn.o_proj.weight': 'float32', 'model.model.layers.2.self_attn.q_norm.weight': 'float32', 'model.model.layers.2.self_attn.k_norm.weight': 'float32', 'model.model.layers.2.mlp.gate_proj.weight': 'float32', 'model.model.layers.2.mlp.up_proj.weight': 'float32', 'model.model.layers.2.mlp.down_proj.weight': 'float32', 'model.model.layers.2.post_attention_layernorm.weight': 'float32', 'model.model.layers.2.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.3.self_attn.q_proj.weight': 'float32', 'model.model.layers.3.self_attn.k_proj.weight': 'float32', 'model.model.layers.3.self_attn.v_proj.weight': 'float32', 'model.model.layers.3.self_attn.o_proj.weight': 'float32', 'model.model.layers.3.self_attn.q_norm.weight': 'float32', 'model.model.layers.3.self_attn.k_norm.weight': 'float32', 'model.model.layers.3.mlp.gate_proj.weight': 'float32', 'model.model.layers.3.mlp.up_proj.weight': 'float32', 'model.model.layers.3.mlp.down_proj.weight': 'float32', 'model.model.layers.3.post_attention_layernorm.weight': 'float32', 'model.model.layers.3.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.4.self_attn.q_proj.weight': 'float32', 'model.model.layers.4.self_attn.k_proj.weight': 'float32', 'model.model.layers.4.self_attn.v_proj.weight': 'float32', 'model.model.layers.4.self_attn.o_proj.weight': 'float32', 'model.model.layers.4.self_attn.q_norm.weight': 'float32', 'model.model.layers.4.self_attn.k_norm.weight': 'float32', 'model.model.layers.4.mlp.gate_proj.weight': 'float32', 'model.model.layers.4.mlp.up_proj.weight': 'float32', 'model.model.layers.4.mlp.down_proj.weight': 'float32', 'model.model.layers.4.post_attention_layernorm.weight': 'float32', 'model.model.layers.4.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.5.self_attn.q_proj.weight': 'float32', 'model.model.layers.5.self_attn.k_proj.weight': 'float32', 'model.model.layers.5.self_attn.v_proj.weight': 'float32', 'model.model.layers.5.self_attn.o_proj.weight': 'float32', 'model.model.layers.5.self_attn.q_norm.weight': 'float32', 'model.model.layers.5.self_attn.k_norm.weight': 'float32', 'model.model.layers.5.mlp.gate_proj.weight': 'float32', 'model.model.layers.5.mlp.up_proj.weight': 'float32', 'model.model.layers.5.mlp.down_proj.weight': 'float32', 'model.model.layers.5.post_attention_layernorm.weight': 'float32', 'model.model.layers.5.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.6.self_attn.q_proj.weight': 'float32', 'model.model.layers.6.self_attn.k_proj.weight': 'float32', 'model.model.layers.6.self_attn.v_proj.weight': 'float32', 'model.model.layers.6.self_attn.o_proj.weight': 'float32', 'model.model.layers.6.self_attn.q_norm.weight': 'float32', 'model.model.layers.6.self_attn.k_norm.weight': 'float32', 'model.model.layers.6.mlp.gate_proj.weight': 'float32', 'model.model.layers.6.mlp.up_proj.weight': 'float32', 'model.model.layers.6.mlp.down_proj.weight': 'float32', 'model.model.layers.6.post_attention_layernorm.weight': 'float32', 'model.model.layers.6.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.7.self_attn.q_proj.weight': 'float32', 'model.model.layers.7.self_attn.k_proj.weight': 'float32', 'model.model.layers.7.self_attn.v_proj.weight': 'float32', 'model.model.layers.7.self_attn.o_proj.weight': 'float32', 'model.model.layers.7.self_attn.q_norm.weight': 'float32', 'model.model.layers.7.self_attn.k_norm.weight': 'float32', 'model.model.layers.7.mlp.gate_proj.weight': 'float32', 'model.model.layers.7.mlp.up_proj.weight': 'float32', 'model.model.layers.7.mlp.down_proj.weight': 'float32', 'model.model.layers.7.post_attention_layernorm.weight': 'float32', 'model.model.layers.7.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.8.self_attn.q_proj.weight': 'float32', 'model.model.layers.8.self_attn.k_proj.weight': 'float32', 'model.model.layers.8.self_attn.v_proj.weight': 'float32', 'model.model.layers.8.self_attn.o_proj.weight': 'float32', 'model.model.layers.8.self_attn.q_norm.weight': 'float32', 'model.model.layers.8.self_attn.k_norm.weight': 'float32', 'model.model.layers.8.mlp.gate_proj.weight': 'float32', 'model.model.layers.8.mlp.up_proj.weight': 'float32', 'model.model.layers.8.mlp.down_proj.weight': 'float32', 'model.model.layers.8.post_attention_layernorm.weight': 'float32', 'model.model.layers.8.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.9.self_attn.q_proj.weight': 'float32', 'model.model.layers.9.self_attn.k_proj.weight': 'float32', 'model.model.layers.9.self_attn.v_proj.weight': 'float32', 'model.model.layers.9.self_attn.o_proj.weight': 'float32', 'model.model.layers.9.self_attn.q_norm.weight': 'float32', 'model.model.layers.9.self_attn.k_norm.weight': 'float32', 'model.model.layers.9.mlp.gate_proj.weight': 'float32', 'model.model.layers.9.mlp.up_proj.weight': 'float32', 'model.model.layers.9.mlp.down_proj.weight': 'float32', 'model.model.layers.9.post_attention_layernorm.weight': 'float32', 'model.model.layers.9.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.10.self_attn.q_proj.weight': 'float32', 'model.model.layers.10.self_attn.k_proj.weight': 'float32', 'model.model.layers.10.self_attn.v_proj.weight': 'float32', 'model.model.layers.10.self_attn.o_proj.weight': 'float32', 'model.model.layers.10.self_attn.q_norm.weight': 'float32', 'model.model.layers.10.self_attn.k_norm.weight': 'float32', 'model.model.layers.10.mlp.gate_proj.weight': 'float32', 'model.model.layers.10.mlp.up_proj.weight': 'float32', 'model.model.layers.10.mlp.down_proj.weight': 'float32', 'model.model.layers.10.post_attention_layernorm.weight': 'float32', 'model.model.layers.10.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.11.self_attn.q_proj.weight': 'float32', 'model.model.layers.11.self_attn.k_proj.weight': 'float32', 'model.model.layers.11.self_attn.v_proj.weight': 'float32', 'model.model.layers.11.self_attn.o_proj.weight': 'float32', 'model.model.layers.11.self_attn.q_norm.weight': 'float32', 'model.model.layers.11.self_attn.k_norm.weight': 'float32', 'model.model.layers.11.mlp.gate_proj.weight': 'float32', 'model.model.layers.11.mlp.up_proj.weight': 'float32', 'model.model.layers.11.mlp.down_proj.weight': 'float32', 'model.model.layers.11.post_attention_layernorm.weight': 'float32', 'model.model.layers.11.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.12.self_attn.q_proj.weight': 'float32', 'model.model.layers.12.self_attn.k_proj.weight': 'float32', 'model.model.layers.12.self_attn.v_proj.weight': 'float32', 'model.model.layers.12.self_attn.o_proj.weight': 'float32', 'model.model.layers.12.self_attn.q_norm.weight': 'float32', 'model.model.layers.12.self_attn.k_norm.weight': 'float32', 'model.model.layers.12.mlp.gate_proj.weight': 'float32', 'model.model.layers.12.mlp.up_proj.weight': 'float32', 'model.model.layers.12.mlp.down_proj.weight': 'float32', 'model.model.layers.12.post_attention_layernorm.weight': 'float32', 'model.model.layers.12.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.13.self_attn.q_proj.weight': 'float32', 'model.model.layers.13.self_attn.k_proj.weight': 'float32', 'model.model.layers.13.self_attn.v_proj.weight': 'float32', 'model.model.layers.13.self_attn.o_proj.weight': 'float32', 'model.model.layers.13.self_attn.q_norm.weight': 'float32', 'model.model.layers.13.self_attn.k_norm.weight': 'float32', 'model.model.layers.13.mlp.gate_proj.weight': 'float32', 'model.model.layers.13.mlp.up_proj.weight': 'float32', 'model.model.layers.13.mlp.down_proj.weight': 'float32', 'model.model.layers.13.post_attention_layernorm.weight': 'float32', 'model.model.layers.13.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.14.self_attn.q_proj.weight': 'float32', 'model.model.layers.14.self_attn.k_proj.weight': 'float32', 'model.model.layers.14.self_attn.v_proj.weight': 'float32', 'model.model.layers.14.self_attn.o_proj.weight': 'float32', 'model.model.layers.14.self_attn.q_norm.weight': 'float32', 'model.model.layers.14.self_attn.k_norm.weight': 'float32', 'model.model.layers.14.mlp.gate_proj.weight': 'float32', 'model.model.layers.14.mlp.up_proj.weight': 'float32', 'model.model.layers.14.mlp.down_proj.weight': 'float32', 'model.model.layers.14.post_attention_layernorm.weight': 'float32', 'model.model.layers.14.post_feedforward_layernorm.weight': 'float32', 'model.model.layers.15.self_attn.q_proj.weight': 'float32', 'model.model.layers.15.self_attn.k_proj.weight': 'float32', 'model.model.layers.15.self_attn.v_proj.weight': 'float32', 'model.model.layers.15.self_attn.o_proj.weight': 'float32', 'model.model.layers.15.self_attn.q_norm.weight': 'float32', 'model.model.layers.15.self_attn.k_norm.weight': 'float32', 'model.model.layers.15.mlp.gate_proj.weight': 'float32', 'model.model.layers.15.mlp.up_proj.weight': 'float32', 'model.model.layers.15.mlp.down_proj.weight': 'float32', 'model.model.layers.15.post_attention_layernorm.weight': 'float32', 'model.model.layers.15.post_feedforward_layernorm.weight': 'float32', 'model.model.norm.weight': 'float32', 'model.lm_head.weight': 'float32'}[0m
🔔 EVENT RECEIVED: _after_task_result_filter
🔔 EVENT RECEIVED: _before_process_submission
🔔 EVENT RECEIVED: _before_contribution_accept
[38m2025-05-20 23:25:43,899 - IntimeModelSelector - INFO - validation metric nan from client site-code[0m
🔔 EVENT RECEIVED: _after_contribution_accept
🔔 EVENT RECEIVED: _after_process_submission
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_aggregation
[38m2025-05-20 23:25:44,439 - FedAvg - INFO - aggregating 3 update(s) at round 2[0m
[38m2025-05-20 23:25:48,904 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:25:48,905 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:25:49,417 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:25:49,534 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:25:49,534 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,534 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:25:49,534 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:49,535 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:25:49,535 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,535 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:25:49,535 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:49,535 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:25:49,536 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,536 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:25:49,536 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:49,536 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:25:49,536 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,536 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:25:49,537 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:25:49,537 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:49,537 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:25:49,537 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,537 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:25:49,537 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:49,538 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:25:49,538 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,538 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:25:49,538 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:25:49,538 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:49,539 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:25:49,539 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,539 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:25:49,539 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:25:49,539 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:49,539 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:25:49,540 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,540 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:25:49,540 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:25:49,540 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:49,540 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:25:49,541 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,541 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:25:49,541 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:25:49,541 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:25:49,541 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,541 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:25:49,542 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:25:49,542 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:25:49,542 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,542 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:25:49,542 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:25:49,542 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,543 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:25:49,543 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:25:49,543 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,543 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:25:49,543 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:25:49,543 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:25:49,544 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:25:49,544 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:25:49,544 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:25:49,544 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:25:49,544 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:25:49,544 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,545 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:25:49,545 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:49,545 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:25:49,545 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:25:49,545 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:25:49,545 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:25:49,545 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:25:49,546 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:25:49,546 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:25:49,546 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:25:49,546 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:25:49,546 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:25:49,546 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:25:49,547 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:25:49,547 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:25:49,547 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:25:49,547 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:25:49,547 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:25:49,547 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:25:49,548 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:25:49,548 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:25:49,548 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:25:49,548 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:25:49,548 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:25:49,548 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:25:49,548 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _after_aggregation
🔔 EVENT RECEIVED: _before_model_update
🔔 EVENT RECEIVED: _after_model_update
[38m2025-05-20 23:25:54,176 - FedAvg - INFO - Start persist model on server.[0m
[38m2025-05-20 23:25:55,002 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:25:55,002 - ModelQuantizer - INFO - Using model quantizator.[0m
[33m2025-05-20 23:25:58,979 - Cell - WARNING - Receiving unknown req_id='05785a90-6f39-4b4c-aeb2-4c2f43c04c45', discarded: '05785a90-6f39-4b4c-aeb2-4c2f43c04c45' headers: {'cn__return_code': 'ok', 'cn__req_id': '', 'cn__msg_type': 'req', 'sm__ri': '05785a90-6f39-4b4c-aeb2-4c2f43c04c45', 'sm__pe': 'fobs', 'cn__payload_len': 405, 'sm__ch': 'return_only', 'sm__tp': 'aux_communication:__sync_runner__', 'sm__sz': 405, 'sm__id': 1750681991950618, 'sm__dt': 2, 'sm__sq': 0, 'sm__os': 0, 'sm__op': True, 'cn__reply_expected': False, 'cn__optional': True, 'cn__secure': False, 'cn__topic': 'sm__DATA', 'cn__channel': 'sm__STREAM', 'cn__destination': 'site-code.simulate_job', 'cn__from': 'server', 'cn__to': 'site-code.simulate_job', 'cn__origin': 'server.simulate_job', 'cn__route': [['server.simulate_job', 1747783558.978732], ['server', 1747783558.978796], ('site-code.simulate_job', 1747783558.9792593)], 'cn__send_time': 1747783558.9787984}[0m
[38m2025-05-20 23:25:59,012 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:25:59,124 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:25:59,124 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,124 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:25:59,124 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:59,124 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:25:59,125 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,125 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:25:59,125 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:59,125 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:25:59,125 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,126 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:25:59,126 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:59,126 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:25:59,126 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,127 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:25:59,127 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:25:59,127 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:59,127 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:25:59,127 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,127 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:25:59,128 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:59,128 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:25:59,128 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,128 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:25:59,128 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:25:59,128 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:59,129 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:25:59,129 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,129 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:25:59,129 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:25:59,129 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:59,130 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:25:59,130 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,130 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:25:59,130 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:25:59,130 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:25:59,130 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:25:59,131 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,131 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:25:59,131 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:25:59,131 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:25:59,131 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,131 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:25:59,132 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:25:59,132 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:25:59,132 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,132 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:25:59,132 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:25:59,132 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,133 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:25:59,133 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:25:59,133 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,133 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:25:59,133 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:25:59,133 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:25:59,134 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:25:59,134 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:25:59,134 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:25:59,134 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:25:59,134 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:25:59,134 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,135 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:25:59,135 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:25:59,135 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:25:59,135 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:25:59,135 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:25:59,135 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:25:59,136 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:25:59,136 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:25:59,136 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:25:59,136 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:25:59,136 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:25:59,136 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:25:59,136 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:25:59,137 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:25:59,137 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:25:59,137 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:25:59,137 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:25:59,137 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:25:59,137 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:25:59,138 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:25:59,138 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:25:59,138 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:25:59,138 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:25:59,138 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:25:59,138 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:25:59,139 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:26:01,760 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy[0m
[38m2025-05-20 23:26:01,760 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy...[0m
[38m2025-05-20 23:26:01,760 - TaskScriptRunner - INFO - data_array shape: (988118026,)[0m
[38m2025-05-20 23:26:01,761 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:26:01,761 - TaskScriptRunner - INFO - data_array size: 988118026[0m
[38m2025-05-20 23:26:11,051 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:26:11,052 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:26:11,909 - TaskScriptRunner - INFO - start task run() with full path: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py[0m
[38m2025-05-20 23:26:12,021 - TaskScriptRunner - INFO -     smart_open supports the following transport mechanisms:[0m
[38m2025-05-20 23:26:12,021 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,021 - TaskScriptRunner - INFO -     file (smart_open/local_file.py)[0m
[38m2025-05-20 23:26:12,021 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:26:12,022 - TaskScriptRunner - INFO -     Implements the transport for the file:// schema.[0m
[38m2025-05-20 23:26:12,022 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,022 - TaskScriptRunner - INFO -     ftp (smart_open/ftp.py)[0m
[38m2025-05-20 23:26:12,022 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:26:12,022 - TaskScriptRunner - INFO -     Implements I/O streams over FTP.[0m
[38m2025-05-20 23:26:12,023 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,023 - TaskScriptRunner - INFO -     gs (smart_open/gcs.py)[0m
[38m2025-05-20 23:26:12,023 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:26:12,023 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing to/from GCS.[0m
[38m2025-05-20 23:26:12,023 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,023 - TaskScriptRunner - INFO -     min_part_size: int, optional
        The minimum part size for multipart uploads. For writing only.
    client: google.cloud.storage.Client, optional
        The GCS client to use when working with google-cloud-storage.
    blob_properties: dict, optional
        Set properties on blob before writing. For writing only.
    blob_open_kwargs: dict, optional
        Additional keyword arguments to propagate to the blob.open method
        of the google-cloud-storage library.
[0m
[38m2025-05-20 23:26:12,024 - TaskScriptRunner - INFO -     hdfs (smart_open/hdfs.py)[0m
[38m2025-05-20 23:26:12,024 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:26:12,024 - TaskScriptRunner - INFO -     Implements reading and writing to/from HDFS.[0m
[38m2025-05-20 23:26:12,024 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,024 - TaskScriptRunner - INFO -     http (smart_open/http.py)[0m
[38m2025-05-20 23:26:12,024 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:26:12,025 - TaskScriptRunner - INFO -     Implements file-like objects for reading from http.[0m
[38m2025-05-20 23:26:12,025 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,025 - TaskScriptRunner - INFO -     kerberos: boolean, optional
        If True, will attempt to use the local Kerberos credentials
    user: str, optional
        The username for authenticating over HTTP
    password: str, optional
        The password for authenticating over HTTP
    cert: str/tuple, optional
        if String, path to ssl client cert file (.pem). If Tuple, (‘cert’, ‘key’)
    headers: dict, optional
        Any headers to send in the request. If ``None``, the default headers are sent:
        ``{'Accept-Encoding': 'identity'}``. To use no headers at all,
        set this variable to an empty dict, ``{}``.
    buffer_size: int, optional
        The buffer size to use when performing I/O.
[0m
[38m2025-05-20 23:26:12,025 - TaskScriptRunner - INFO -     s3 (smart_open/s3.py)[0m
[38m2025-05-20 23:26:12,025 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:26:12,026 - TaskScriptRunner - INFO -     Implements file-like objects for reading and writing from/to AWS S3.[0m
[38m2025-05-20 23:26:12,026 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,026 - TaskScriptRunner - INFO -     buffer_size: int, optional
        The buffer size to use when performing I/O.
    min_part_size: int, optional
        The minimum part size for multipart uploads.  For writing only.
    multipart_upload: bool, optional
        Default: `True`
        If set to `True`, will use multipart upload for writing to S3. If set
        to `False`, S3 upload will use the S3 Single-Part Upload API, which
        is more ideal for small file sizes.
        For writing only.
    version_id: str, optional
        Version of the object, used when reading object.
        If None, will fetch the most recent version.
    defer_seek: boolean, optional
        Default: `False`
        If set to `True` on a file opened for reading, GetObject will not be
        called until the first seek() or read().
        Avoids redundant API queries when seeking before reading.
    client: object, optional
        The S3 client to use when working with boto3.
        If you don't specify this, then smart_open will create a new client for you.
    client_kwargs: dict, optional
        Additional parameters to pass to the relevant functions of the client.
        The keys are fully qualified method names, e.g. `S3.Client.create_multipart_upload`.
        The values are kwargs to pass to that method each time it is called.
    writebuffer: IO[bytes], optional
        By default, this module will buffer data in memory using io.BytesIO
        when writing. Pass another binary IO instance here to use it instead.
        For example, you may pass a file object to buffer to local disk instead
        of in RAM. Use this to keep RAM usage low at the expense of additional
        disk IO. If you pass in an open file, then you are responsible for
        cleaning it up after writing completes.
[0m
[38m2025-05-20 23:26:12,026 - TaskScriptRunner - INFO -     scp (smart_open/ssh.py)[0m
[38m2025-05-20 23:26:12,026 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:26:12,027 - TaskScriptRunner - INFO -     Implements I/O streams over SSH.[0m
[38m2025-05-20 23:26:12,027 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,027 - TaskScriptRunner - INFO -     mode: str, optional
        The mode to use for opening the file.
    host: str, optional
        The hostname of the remote machine.  May not be None.
    user: str, optional
        The username to use to login to the remote machine.
        If None, defaults to the name of the current user.
    password: str, optional
        The password to use to login to the remote machine.
    port: int, optional
        The port to connect to.
    transport_params: dict, optional
        Any additional settings to be passed to paramiko.SSHClient.connect
[0m
[38m2025-05-20 23:26:12,027 - TaskScriptRunner - INFO -     webhdfs (smart_open/webhdfs.py)[0m
[38m2025-05-20 23:26:12,027 - TaskScriptRunner - INFO -     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[38m2025-05-20 23:26:12,027 - TaskScriptRunner - INFO -     Implements reading and writing to/from WebHDFS.[0m
[38m2025-05-20 23:26:12,028 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,028 - TaskScriptRunner - INFO -     min_part_size: int, optional
        For writing only.
[0m
[38m2025-05-20 23:26:12,028 - TaskScriptRunner - INFO -     Examples[0m
[38m2025-05-20 23:26:12,028 - TaskScriptRunner - INFO -     --------[0m
[38m2025-05-20 23:26:12,028 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,028 - TaskScriptRunner - INFO -     See README.rst[0m
[38m2025-05-20 23:26:12,029 - TaskScriptRunner - INFO -     This function also supports transparent compression and decompression [0m
[38m2025-05-20 23:26:12,029 - TaskScriptRunner - INFO -     using the following codecs:[0m
[38m2025-05-20 23:26:12,029 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,029 - TaskScriptRunner - INFO -     * .bz2[0m
[38m2025-05-20 23:26:12,029 - TaskScriptRunner - INFO -     * .gz[0m
[38m2025-05-20 23:26:12,029 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,030 - TaskScriptRunner - INFO -     The function depends on the file extension to determine the appropriate codec.[0m
[38m2025-05-20 23:26:12,030 - TaskScriptRunner - INFO -     Supported URI schemes are:[0m
[38m2025-05-20 23:26:12,030 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,030 - TaskScriptRunner - INFO -     * file[0m
[38m2025-05-20 23:26:12,030 - TaskScriptRunner - INFO -     * ftp[0m
[38m2025-05-20 23:26:12,030 - TaskScriptRunner - INFO -     * gs[0m
[38m2025-05-20 23:26:12,031 - TaskScriptRunner - INFO -     * hdfs[0m
[38m2025-05-20 23:26:12,031 - TaskScriptRunner - INFO -     * http[0m
[38m2025-05-20 23:26:12,031 - TaskScriptRunner - INFO -     * s3[0m
[38m2025-05-20 23:26:12,031 - TaskScriptRunner - INFO -     * scp[0m
[38m2025-05-20 23:26:12,031 - TaskScriptRunner - INFO -     * webhdfs[0m
[38m2025-05-20 23:26:12,031 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,032 - TaskScriptRunner - INFO -     Valid URI examples::[0m
[38m2025-05-20 23:26:12,032 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:12,032 - TaskScriptRunner - INFO -     * ./local/path/file[0m
[38m2025-05-20 23:26:12,032 - TaskScriptRunner - INFO -     * ~/local/path/file[0m
[38m2025-05-20 23:26:12,032 - TaskScriptRunner - INFO -     * local/path/file[0m
[38m2025-05-20 23:26:12,032 - TaskScriptRunner - INFO -     * ./local/path/file.gz[0m
[38m2025-05-20 23:26:12,033 - TaskScriptRunner - INFO -     * file:///home/user/file[0m
[38m2025-05-20 23:26:12,033 - TaskScriptRunner - INFO -     * file:///home/user/file.bz2[0m
[38m2025-05-20 23:26:12,033 - TaskScriptRunner - INFO -     * ftp://username@host/path/file[0m
[38m2025-05-20 23:26:12,033 - TaskScriptRunner - INFO -     * ftp://username:password@host/path/file[0m
[38m2025-05-20 23:26:12,033 - TaskScriptRunner - INFO -     * ftp://username:password@host:port/path/file[0m
[38m2025-05-20 23:26:12,033 - TaskScriptRunner - INFO -     * ftps://username@host/path/file[0m
[38m2025-05-20 23:26:12,034 - TaskScriptRunner - INFO -     * ftps://username:password@host/path/file[0m
[38m2025-05-20 23:26:12,034 - TaskScriptRunner - INFO -     * ftps://username:password@host:port/path/file[0m
[38m2025-05-20 23:26:12,034 - TaskScriptRunner - INFO -     * hdfs:///path/file[0m
[38m2025-05-20 23:26:12,034 - TaskScriptRunner - INFO -     * hdfs://path/file[0m
[38m2025-05-20 23:26:12,034 - TaskScriptRunner - INFO -     * viewfs:///path/file[0m
[38m2025-05-20 23:26:12,034 - TaskScriptRunner - INFO -     * viewfs://path/file[0m
[38m2025-05-20 23:26:12,034 - TaskScriptRunner - INFO -     * s3://my_bucket/my_key[0m
[38m2025-05-20 23:26:12,035 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_bucket/my_key[0m
[38m2025-05-20 23:26:12,035 - TaskScriptRunner - INFO -     * s3://my_key:my_secret@my_server:my_port@my_bucket/my_key[0m
[38m2025-05-20 23:26:12,035 - TaskScriptRunner - INFO -     * ssh://username@host/path/file[0m
[38m2025-05-20 23:26:12,035 - TaskScriptRunner - INFO -     * ssh://username@host//path/file[0m
[38m2025-05-20 23:26:12,035 - TaskScriptRunner - INFO -     * scp://username@host/path/file[0m
[38m2025-05-20 23:26:12,035 - TaskScriptRunner - INFO -     * sftp://username@host/path/file[0m
[38m2025-05-20 23:26:12,036 - TaskScriptRunner - INFO -     * webhdfs://host:port/path/file[0m
[38m2025-05-20 23:26:14,700 - TaskScriptRunner - INFO - Attempting to load training data from: /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy[0m
[38m2025-05-20 23:26:14,700 - TaskScriptRunner - INFO - Loading data from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy...[0m
[38m2025-05-20 23:26:14,700 - TaskScriptRunner - INFO - data_array shape: (468993355,)[0m
[38m2025-05-20 23:26:14,701 - TaskScriptRunner - INFO - data_array dtype: uint32[0m
[38m2025-05-20 23:26:14,701 - TaskScriptRunner - INFO - data_array size: 468993355[0m
[38m2025-05-20 23:26:19,077 - TaskScriptRunner - INFO - 988118026 len text_list[0m
[38m2025-05-20 23:26:22,251 - ModelDequantizer - INFO - Using model dequantizator.[0m
[38m2025-05-20 23:26:22,252 - ModelQuantizer - INFO - Using model quantizator.[0m
[38m2025-05-20 23:26:22,883 - TaskScriptRunner - INFO - 468993355 len text_list[0m
[33m2025-05-20 23:26:22,884 - CoreCell - WARNING - site-lbv1.simulate_job: no waiter for req 8baf4091-5938-497c-85eb-ea1423f6e784 - the reply is too late[0m
[38m2025-05-20 23:26:26,884 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:26:26,971 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/code/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:26:26,976 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:26:26,976 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:26:26,977 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:26:26,977 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:26,977 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:26,977 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:26,978 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:26:26,978 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:26,978 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:26:26,978 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:26:26,978 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:26:26,978 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:26,979 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:26,979 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:26,979 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:26,979 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:26:26,979 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:26:26,980 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:26,980 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:26:26,980 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:26:26,980 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:26:26,980 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:26,980 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:26,981 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:26,981 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:26:26,981 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:26,981 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:26:26,981 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:26,981 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:26:26,982 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:26,982 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:26,982 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:26,982 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:26:26,982 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:26,982 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:26:26,983 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:26:26,983 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:26,983 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:26:26,983 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:26:26,983 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:26:26,983 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:26:26,984 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f2711d83ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:26:26,984 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:26:26,984 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:26:26,984 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:26:26,984 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:26:26,985 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:26:26,985 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:26,985 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:26:26,985 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:26:26,985 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:26,985 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:26,986 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:26:26,986 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:26:26,986 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:26,986 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:26,986 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:26:26,986 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:26,987 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:26:26,987 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:26:26,987 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:26,987 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:26:26,987 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:26:26,987 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:26,988 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:26,988 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:26:26,988 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:26,988 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f2711d83ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:26:26,988 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:26:26,988 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:26:26,989 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:26:26,989 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:26:26,989 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:26,989 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:26,989 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:26,989 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:26,990 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:26:26,990 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:26:26,990 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:26,990 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:26:26,990 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:26:26,991 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:26:26,991 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:26:26,991 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:26:26,991 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:26:26,991 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:26:26,991 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:26,992 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:26,992 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:26,992 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:26,992 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:26:26,992 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:26:26,992 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:26,993 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:26:26,993 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:26:26,993 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 246785.35 examples/s]
[38m2025-05-20 23:26:27,035 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:26:27,035 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:27,035 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:27,036 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:27,036 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:26:27,036 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:27,036 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:26:27,036 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:26:27,036 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:26:27,037 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:27,037 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:27,037 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:27,037 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:27,037 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:26:27,037 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:26:27,038 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:27,038 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:26:27,038 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:26:27,038 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:26:27,038 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:27,038 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:27,039 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:27,039 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:26:27,039 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:27,039 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:26:27,039 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:27,039 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:26:27,040 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:27,040 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:27,040 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:27,040 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:26:27,040 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:27,040 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:26:27,041 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:26:27,041 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:27,041 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:26:27,041 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:26:27,041 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:26:27,041 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:26:27,042 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7f2711d83ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:26:27,042 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:26:27,042 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:26:27,042 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:26:27,042 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:26:27,042 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:26:27,043 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:27,043 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:26:27,043 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:26:27,043 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:27,043 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:27,043 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:26:27,044 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:26:27,044 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:27,044 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:27,044 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:26:27,044 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:27,044 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:26:27,045 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:26:27,045 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:27,045 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:26:27,045 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:26:27,045 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:27,045 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:27,046 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:26:27,046 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:27,046 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7f2711d83ec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-code/simulate_job/app_site-code/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:26:27,046 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:26:27,046 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:26:27,046 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:26:27,047 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:26:27,047 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:27,047 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:27,047 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:27,047 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:27,047 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:26:27,048 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:26:27,048 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:27,048 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:26:27,048 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:26:27,048 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:26:27,048 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:26:27,049 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:26:27,049 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:26:27,049 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:26:27,049 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:27,049 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:27,050 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:27,050 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:27,050 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:26:27,050 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:26:27,050 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:27,050 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:26:27,051 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:26:27,051 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 62147.04 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][38m2025-05-20 23:26:28,552 - TaskScriptRunner - INFO - 10000 len text_list[0m
[38m2025-05-20 23:26:28,578 - TaskScriptRunner - INFO - Validation data path is same as train or not specified separately. Splitting training data (from /workspace/NVFlare/examples/advanced/llm_hf/data/lbv1/train.npy) for validation (1% test size).[0m
[38m2025-05-20 23:26:28,582 - TaskScriptRunner - INFO - Dataset size: training 9900, validation 100[0m
[38m2025-05-20 23:26:28,583 - TaskScriptRunner - INFO - Raw dataset structure after loading: DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 9900
    })
    validation: Dataset({
        features: ['text'],
        num_rows: 100
    })
})[0m
[38m2025-05-20 23:26:28,583 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:26:28,584 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:28,584 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:28,584 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,584 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:26:28,584 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,584 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:26:28,585 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:26:28,585 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:26:28,585 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,585 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:28,585 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:28,586 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,586 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:26:28,586 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:26:28,586 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,586 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:26:28,586 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:26:28,587 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:26:28,587 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:28,587 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:28,587 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,587 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:26:28,587 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:28,588 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:26:28,588 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,588 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:26:28,588 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:28,588 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:28,588 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:28,589 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:26:28,589 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:28,589 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:26:28,589 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:26:28,589 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,589 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:26:28,590 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:26:28,590 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:26:28,590 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:26:28,590 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7fe36251bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:26:28,590 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:26:28,590 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:26:28,591 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:26:28,591 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:26:28,591 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:26:28,591 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:28,591 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:26:28,591 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:26:28,592 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:28,592 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,592 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:26:28,592 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:26:28,592 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,592 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:28,593 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:26:28,593 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,593 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:26:28,593 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:26:28,593 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:28,593 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:26:28,593 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:26:28,594 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,594 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:28,594 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:26:28,594 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,594 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7fe36251bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:26:28,594 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:26:28,595 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:26:28,595 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:26:28,595 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:26:28,595 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:28,595 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:28,595 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:28,596 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:28,596 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:26:28,596 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:26:28,596 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,596 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:26:28,596 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:26:28,597 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:26:28,597 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:26:28,597 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:26:28,597 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:26:28,597 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:26:28,598 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:28,598 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:28,598 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:28,598 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:28,598 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:26:28,598 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:26:28,598 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,599 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:26:28,599 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:26:28,599 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/9900 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 9900/9900 [00:00<00:00, 239050.84 examples/s]
[38m2025-05-20 23:26:28,642 - TaskScriptRunner - INFO - 102           0 LOAD_GLOBAL              0 (isinstance)[0m
[38m2025-05-20 23:26:28,642 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:28,643 - TaskScriptRunner - INFO -               4 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:28,643 - TaskScriptRunner - INFO -               6 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,643 - TaskScriptRunner - INFO -               8 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:26:28,643 - TaskScriptRunner - INFO -              10 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,643 - TaskScriptRunner - INFO -              12 LOAD_GLOBAL              1 (int)[0m
[38m2025-05-20 23:26:28,643 - TaskScriptRunner - INFO -              14 CALL_FUNCTION            2[0m
[38m2025-05-20 23:26:28,644 - TaskScriptRunner - INFO -              16 POP_JUMP_IF_FALSE       14 (to 28)[0m
[38m2025-05-20 23:26:28,644 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,644 - TaskScriptRunner - INFO - 104          18 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:28,644 - TaskScriptRunner - INFO -              20 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:28,644 - TaskScriptRunner - INFO -              22 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,645 - TaskScriptRunner - INFO -              24 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:26:28,645 - TaskScriptRunner - INFO -              26 JUMP_FORWARD             9 (to 46)[0m
[38m2025-05-20 23:26:28,645 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,645 - TaskScriptRunner - INFO - 107     >>   28 LOAD_GLOBAL              2 (list)[0m
[38m2025-05-20 23:26:28,645 - TaskScriptRunner - INFO -              30 LOAD_GLOBAL              3 (chain)[0m
[38m2025-05-20 23:26:28,645 - TaskScriptRunner - INFO -              32 LOAD_METHOD              4 (from_iterable)[0m
[38m2025-05-20 23:26:28,646 - TaskScriptRunner - INFO -              34 LOAD_FAST                0 (examples)[0m
[38m2025-05-20 23:26:28,646 - TaskScriptRunner - INFO -              36 LOAD_CONST               1 ('text')[0m
[38m2025-05-20 23:26:28,646 - TaskScriptRunner - INFO -              38 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,646 - TaskScriptRunner - INFO -              40 CALL_METHOD              1[0m
[38m2025-05-20 23:26:28,646 - TaskScriptRunner - INFO -              42 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:28,646 - TaskScriptRunner - INFO -              44 STORE_DEREF              0 (all_tokens)[0m
[38m2025-05-20 23:26:28,647 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,647 - TaskScriptRunner - INFO - 110     >>   46 LOAD_GLOBAL              5 (len)[0m
[38m2025-05-20 23:26:28,647 - TaskScriptRunner - INFO -              48 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:28,647 - TaskScriptRunner - INFO -              50 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:28,647 - TaskScriptRunner - INFO -              52 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:28,647 - TaskScriptRunner - INFO -              54 BINARY_FLOOR_DIVIDE[0m
[38m2025-05-20 23:26:28,648 - TaskScriptRunner - INFO -              56 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:28,648 - TaskScriptRunner - INFO -              58 BINARY_MULTIPLY[0m
[38m2025-05-20 23:26:28,648 - TaskScriptRunner - INFO -              60 STORE_FAST               2 (total_len)[0m
[38m2025-05-20 23:26:28,648 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,648 - TaskScriptRunner - INFO - 114          62 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:26:28,648 - TaskScriptRunner - INFO -              64 LOAD_CLOSURE             0 (all_tokens)[0m
[38m2025-05-20 23:26:28,649 - TaskScriptRunner - INFO -              66 LOAD_CLOSURE             1 (block_size)[0m
[38m2025-05-20 23:26:28,649 - TaskScriptRunner - INFO -              68 BUILD_TUPLE              2[0m
[38m2025-05-20 23:26:28,649 - TaskScriptRunner - INFO -              70 LOAD_CONST               4 (<code object <listcomp> at 0x7fe36251bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>)[0m
[38m2025-05-20 23:26:28,649 - TaskScriptRunner - INFO -              72 LOAD_CONST               5 ('group_tokens.<locals>.<listcomp>')[0m
[38m2025-05-20 23:26:28,649 - TaskScriptRunner - INFO -              74 MAKE_FUNCTION            8 (closure)[0m
[38m2025-05-20 23:26:28,649 - TaskScriptRunner - INFO -              76 LOAD_GLOBAL              6 (range)[0m
[38m2025-05-20 23:26:28,650 - TaskScriptRunner - INFO -              78 LOAD_CONST               2 (0)[0m
[38m2025-05-20 23:26:28,650 - TaskScriptRunner - INFO -              80 LOAD_FAST                2 (total_len)[0m
[38m2025-05-20 23:26:28,650 - TaskScriptRunner - INFO -              82 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:28,650 - TaskScriptRunner - INFO -              84 CALL_FUNCTION            3[0m
[38m2025-05-20 23:26:28,650 - TaskScriptRunner - INFO -              86 GET_ITER[0m
[38m2025-05-20 23:26:28,650 - TaskScriptRunner - INFO -              88 CALL_FUNCTION            1[0m
[38m2025-05-20 23:26:28,651 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,651 - TaskScriptRunner - INFO - 113          90 BUILD_MAP                1[0m
[38m2025-05-20 23:26:28,651 - TaskScriptRunner - INFO -              92 STORE_FAST               3 (result)[0m
[38m2025-05-20 23:26:28,651 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,651 - TaskScriptRunner - INFO - 118          94 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:28,651 - TaskScriptRunner - INFO -              96 LOAD_CONST               3 ('input_ids')[0m
[38m2025-05-20 23:26:28,651 - TaskScriptRunner - INFO -              98 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,652 - TaskScriptRunner - INFO -             100 LOAD_METHOD              7 (copy)[0m
[38m2025-05-20 23:26:28,652 - TaskScriptRunner - INFO -             102 CALL_METHOD              0[0m
[38m2025-05-20 23:26:28,652 - TaskScriptRunner - INFO -             104 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:28,652 - TaskScriptRunner - INFO -             106 LOAD_CONST               6 ('labels')[0m
[38m2025-05-20 23:26:28,652 - TaskScriptRunner - INFO -             108 STORE_SUBSCR[0m
[38m2025-05-20 23:26:28,652 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,653 - TaskScriptRunner - INFO - 120         110 LOAD_FAST                3 (result)[0m
[38m2025-05-20 23:26:28,653 - TaskScriptRunner - INFO -             112 RETURN_VALUE[0m
[38m2025-05-20 23:26:28,653 - TaskScriptRunner - INFO - [0m
[38m2025-05-20 23:26:28,653 - TaskScriptRunner - INFO - Disassembly of <code object <listcomp> at 0x7fe36251bec0, file "/workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/site-lbv1/simulate_job/app_site-lbv1/custom/src/pretrain_nvflare.py", line 114>:[0m
[38m2025-05-20 23:26:28,653 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:26:28,653 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:26:28,654 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:26:28,654 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:26:28,654 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:28,654 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:28,654 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:28,654 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:28,655 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:26:28,655 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:26:28,655 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,655 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:26:28,655 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:26:28,655 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
[38m2025-05-20 23:26:28,656 - TaskScriptRunner - INFO - 114           0 BUILD_LIST               0[0m
[38m2025-05-20 23:26:28,656 - TaskScriptRunner - INFO -               2 LOAD_FAST                0 (.0)[0m
[38m2025-05-20 23:26:28,656 - TaskScriptRunner - INFO -         >>    4 FOR_ITER                10 (to 26)[0m
[38m2025-05-20 23:26:28,656 - TaskScriptRunner - INFO -               6 STORE_FAST               1 (i)[0m
[38m2025-05-20 23:26:28,656 - TaskScriptRunner - INFO -               8 LOAD_DEREF               0 (all_tokens)[0m
[38m2025-05-20 23:26:28,656 - TaskScriptRunner - INFO -              10 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:28,657 - TaskScriptRunner - INFO -              12 LOAD_FAST                1 (i)[0m
[38m2025-05-20 23:26:28,657 - TaskScriptRunner - INFO -              14 LOAD_DEREF               1 (block_size)[0m
[38m2025-05-20 23:26:28,657 - TaskScriptRunner - INFO -              16 BINARY_ADD[0m
[38m2025-05-20 23:26:28,657 - TaskScriptRunner - INFO -              18 BUILD_SLICE              2[0m
[38m2025-05-20 23:26:28,657 - TaskScriptRunner - INFO -              20 BINARY_SUBSCR[0m
[38m2025-05-20 23:26:28,657 - TaskScriptRunner - INFO -              22 LIST_APPEND              2[0m
[38m2025-05-20 23:26:28,658 - TaskScriptRunner - INFO -              24 JUMP_ABSOLUTE            2 (to 4)[0m
[38m2025-05-20 23:26:28,658 - TaskScriptRunner - INFO -         >>   26 RETURN_VALUE[0m
Packing into 512-token blocks:   0%|          | 0/100 [00:00<?, ? examples/s]Packing into 512-token blocks: 100%|██████████| 100/100 [00:00<00:00, 67302.70 examples/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]🔔 EVENT RECEIVED: _before_save_model
📥 SAVE MODEL called
  🔍 Model meta: {'nr_aggregated': 3, 'current_round': 2}
  🔍 Found current round: 2
  ℹ️ Current round: 2
💾 SAVING MODEL FILE: /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_2_model
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
✅ SAVED PyTorch model to /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_2_model.pt
🔄 Saving in HF format to /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_2_model_hf
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
  ✅ Copied config.json
  ✅ Copied tokenizer.json
  ✅ Copied tokenizer_config.json
  ✅ Copied vocab.json
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
  ✅ Copied merges.txt
  ✅ Copied special_tokens_map.json
  🔄 Saving model weights
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
  ✅ Saved model weights to /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir/server/simulate_job/app_server/round_2_model_hf/model.safetensors
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
  📁 HF directory contents: ['config.json', 'vocab.json', 'merges.txt', 'model.safetensors', 'tokenizer.json', 'tokenizer_config.json', 'special_tokens_map.json']
🔔 EVENT RECEIVED: _after_save_model
[38m2025-05-20 23:26:46,448 - FedAvg - INFO - End persist model on server.[0m
[38m2025-05-20 23:26:46,449 - FedAvg - INFO - Finished FedAvg.[0m
[33m2025-05-20 23:26:47,132 - InProcessClientAPI - WARNING - ask to stop job: reason: END_RUN received[0m
[33m2025-05-20 23:26:47,244 - InProcessClientAPI - WARNING - request to stop the job for reason END_RUN received[0m
wandb: - 0.112 MB of 0.112 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:         train/epoch ▁▁▅▅██
wandb:   train/global_step ▁▁▅▅██
wandb:     train/grad_norm ▁▁█
wandb: train/learning_rate ▁█▁
wandb:          train/loss ▁▁█
wandb: 
wandb: Run summary:
wandb:               total_flos 117909120614400.0
wandb:              train/epoch 3.0
wandb:        train/global_step 3
wandb:          train/grad_norm 19.75
wandb:      train/learning_rate 0.0
wandb:               train/loss 8.0056
wandb:               train_loss 2.66853
wandb:            train_runtime 19.1945
wandb: train_samples_per_second 1.563
wandb:   train_steps_per_second 0.156
wandb: 
wandb: 🚀 View run pretrain-math-OLMo-2-0425-1B at: https://wandb.ai/allenai-team1/nvflare/runs/math-OLMo-2-0425-1B-1747782882
wandb: ⭐️ View project at: https://wandb.ai/allenai-team1/nvflare
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250520_231443-math-OLMo-2-0425-1B-1747782882/logs
[31m2025-05-20 23:27:22,496 - ClientTaskWorker - ERROR - do_one_task execute exception: RuntimeError: cannot sync with server Runner after 60.0 seconds[0m
[31m2025-05-20 23:27:22,496 - root - ERROR - Traceback (most recent call last):
  File "/home/kevinfarhat/.local/lib/python3.10/site-packages/nvflare/private/fed/app/simulator/simulator_worker.py", line 87, in do_one_task
    self.create_client_runner(client)
  File "/home/kevinfarhat/.local/lib/python3.10/site-packages/nvflare/private/fed/app/simulator/simulator_worker.py", line 78, in create_client_runner
    client_runner.init_run(app_client_root, args)
  File "/home/kevinfarhat/.local/lib/python3.10/site-packages/nvflare/private/fed/client/client_runner.py", line 666, in init_run
    raise RuntimeError(f"cannot sync with {target} Runner after {max_sync_timeout} seconds")
RuntimeError: cannot sync with server Runner after 60.0 seconds
[0m
🔔 EVENT RECEIVED: _before_process_task_request
🔔 EVENT RECEIVED: _after_process_task_request
🔔 EVENT RECEIVED: _end_workflow
🔔 EVENT RECEIVED: _about_to_end_run
🔔 EVENT RECEIVED: _check_end_run_readiness
🔔 EVENT RECEIVED: _end_run
The number of threads smaller than the number of clients, runner clean-up will be performed.
job_dir= /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/jobdir
workspace_dir= /workspace/NVFlare/examples/advanced/llm_hf/hf_pretrain/workdir
num_threads= 1
